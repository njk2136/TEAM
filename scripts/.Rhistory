summary(m1)
anhedonics <- matched_data %>%
subset(group=="Musical Anhedonics")
matched_controls <- matched_data %>%
subset(group=="Matched Controls")
t.test(anhedonics$MH_total, matched_controls$MH_total)
## separate timing / dimensionality modeling stuff with other hypotheses ##
## DIGITALLY GENERATED SOUDNS
#pleasing
#just childhood dimensions
m1 <- lmer(rating ~ QUIC_child_total + CHAOS_child_total + deprivation_child_total + threat_childhood_total + (1 | ID) + (1 | soundID), data=digital_pleasing)
summary(m1)
#just adolescence dimensions
m1 <- lmer(rating ~ QUIC_Adolescence_total + CHAOS_Adolescence_total + deprivation_Adolescence_total + threat_adolescence_total + (1 | ID) + (1 | soundID), data=digital_pleasing)
summary(m1)
library(tidyverse)
library(lmerTest)
library(MuMIn)
library(AICcmodavg)
library(sjPlot)
library(corrplot)
library(psych)
#generate correlation matrix
#gather variables of interest
variables = dplyr::select(all_scored,
BMRQ_total, BMRQ_moodreg, BMRQ_emotion, BMRQ_socialreward,
BMRQ_absorption, BMRQ_musicseek, BMRQ_sensorimotor, QUIC_sum,
CHAOS_sum, deprivation_sum, Threat_sum)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor', "QUIC Sum", "CHAOS Sum", "Deprivation Sum", "Threat Sum")
rownames(corr_matrix) <- c('Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor', "QUIC Sum", "CHAOS Sum", "Deprivation Sum", "Threat Sum")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
library(tidyverse)
library(psych)
library(corrplot)
library(moments)
source("reverseCode.R")
MH <- read.csv(file='../data/pleasing-displeasing_followup/scored_data.csv') %>%
select("M.H1_1":"M.H35_1")
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H17_1","M.H18_1","M.H20_1","M.H23_1","M.H24_1","M.H29_1","M.H30_1",
"M.H32_1")
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode, min=1, max=7)
cor(MH)
corrplot(as.matrix(cor(MH,use="complete.obs")), method="number")
#this function is the Kaiser-Myer-Olkin Criterion
KMO(r=cor(MH,use="complete.obs" ))
#Bartlett test of sphericity
cortest.bartlett(MH)
#visual inspection of a skreeplot
fafitfree <- fa(MH,nfactors = ncol(MH), rotate = "varimax")
n_factors <- length(fafitfree$e.values)
scree     <- data.frame(
Factor_n =  as.factor(1:n_factors),
Eigenvalue = fafitfree$e.values)
ggplot(scree, aes(x = Factor_n, y = Eigenvalue, group = 1)) +
geom_point() + geom_line() +
xlab("Number of factors") +
ylab("Initial eigenvalue") +
labs( title = "Scree Plot",
subtitle = "(Based on the unreduced correlation matrix)")+
geom_line(y=1,color="red")
#reurn everything w/o check questions
updateMH <- MH[-c(32:34)]
fafitfree <- fa(updateMH,nfactors = ncol(updateMH), rotate = "varimax")
n_factors <- length(fafitfree$e.values)
scree     <- data.frame(
Factor_n =  as.factor(1:n_factors),
Eigenvalue = fafitfree$e.values)
ggplot(scree, aes(x = Factor_n, y = Eigenvalue, group = 1)) +
geom_point() + geom_line() +
xlab("Number of factors") +
ylab("Initial eigenvalue") +
labs( title = "Scree Plot",
subtitle = "(Based on the unreduced correlation matrix)")+
geom_line(y=1,color="red")
parallel <- fa.parallel(updateMH)
fa.none <- fa(r=updateMH,
nfactors = 6,
covar = FALSE, SMC = TRUE,
fm="ml",
max.iter=100,
rotate="varimax") # none rotation
print(fa.none)
fa.diagram(fa.none)
View(MH)
cor(updateMH)
cor(updateMH,use="complete.obs")
corrplot(as.matrix(cor(updateMH,use="complete.obs")), method="number")
#this function is the Kaiser-Myer-Olkin Criterion
KMO(r=cor(updateMH,use="complete.obs" ))
#Bartlett test of sphericity
cortest.bartlett(updateMH)
View(updateMH)
library(tidyverse)
library(lme4)
library(mediation)
library(lmerTest)
library(performance)
library(sjPlot)
scored_data <- read.csv(file="../data/pleasing-displeasing_followup/scored_data.csv")
master <- read.csv(file="../data/pleasing-displeasing_followup/pleasing_displeasing_scored.csv")
matched_data <- read.csv("../data/pleasing-displeasing_followup/matched_data.csv")
master <- master[-1]
names(master)[1] <- "ID"
names(master)[10:21] <- c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J','K','L')
names(master)[22:31] <-c('IADS105','IADS110','IADS220','IADS283','IADS351','IADS353',
'IADS423','IADS502','IADS717','IADS730')
names(master)[32:39] <- c('Envi1','Envi2','Envi3','Envi4','Envi5','Envi6','Envi7','Envi8')
just_ratings<-master[10:39] -4
cleaned <- cbind(master[1], just_ratings)
cleaned <- cbind(cleaned, master[267])
derived <- cleaned[1:13]
derivedstims <- pivot_longer(derived, A:L, names_to = "stim_name", values_to = "rating" )
IADS <- cleaned[14:23]
IADS <- cbind(cleaned[1], IADS)
IADS <- cbind(cleaned[32], IADS)
IADS_stims <- pivot_longer(IADS, IADS105:IADS730, names_to = "stim_name", values_to = "rating" )
envi <- just_ratings[23:30]
envi <- cbind(cleaned[1], envi)
envi_stims <- pivot_longer(envi, Envi1:Envi8, names_to = "stim_name", values_to = "rating" )
#changing stim names for pleasing/displeasing comparisons
names(derived)[2:13] <- c("Displeasing1", "Displeasing2", "Pleasing3","Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Pleasing10", "Pleasing11", "Displeasing12")
derived_plsdispls <- pivot_longer(derived, !ID, names_to = "soundID", values_to = "rating" )
derived_plsdispls$stim_name <- gsub("[0-9]", "", derived_plsdispls$soundID)
names(IADS)[3:12] <- c("Displeasing1", "Pleasing2", "Pleasing3", "Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Displeasing10")
IADS_plsdispls <- pivot_longer(IADS, !PASS_total:ID, names_to = "soundID", values_to = "rating")
IADS_plsdispls$stim_name <- gsub("[0-9]", "", IADS_plsdispls$soundID)
names(envi)[2:9] <- c("Displeasing1", "Displeasing2", "Pleasing3", "Pleasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8")
envi_plsdispls <- pivot_longer(envi, !ID, names_to = "soundID", values_to = "rating")
envi_plsdispls$stim_name <- gsub("[0-9]", "", envi_plsdispls$soundID)
names(scored_data)[20] <- "ID"
names(matched_data)[3] <- "ID"
all_scored <- merge(master, scored_data, by.x="ID", by.y="ID")
digital <-merge(derived_plsdispls, scored_data, by.x="ID", by.y="ID")
digital_pleasing <- subset(digital, stim_name=="Pleasing")
digital_displeasing <- subset(digital, stim_name=="Displeasing")
IADS<-merge(IADS_plsdispls, scored_data, by.x="ID", by.y="ID")
IADS_pleasing <- subset(IADS, stim_name=="Pleasing")
IADS_displeasing <- subset(IADS, stim_name=="Displeasing")
all_scored <- merge(master, scored_data, by.x="ID", by.y="ID")
digital <-merge(derived_plsdispls, scored_data, by.x="ID", by.y="ID")
digital_pleasing <- subset(digital, stim_name=="Pleasing")
digital_displeasing <- subset(digital, stim_name=="Displeasing")
IADS<-merge(IADS_plsdispls, scored_data, by.x="ID", by.y="ID")
IADS_pleasing <- subset(IADS, stim_name=="Pleasing")
IADS_displeasing <- subset(IADS, stim_name=="Displeasing")
envi <- merge(envi_plsdispls, scored_data, by.x="ID", by.y="ID")
envi_pleasing <- subset(envi, stim_name=="Pleasing")
envi_displeasing <- subset(envi, stim_name=="Displeasing")
matched_data <- merge(matched_data, scored_data, by.x="ID", by.y="ID")
#HUMS - both adolescent + current
m1 <- lm(HUMS_adolescence_unhealthy ~ CHAOS_sum + QUIC_sum + deprivation_sum + Threat_sum, data=all_scored)
#HUMS - both adolescent + current
m1 <- lm(HUMS_adolescence_unhealthy ~ CHAOS_sum + QUIC_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
#HUMS - both adolescent + current
m1 <- lm(HUMS_adolescence_unhealthy ~  QUIC_sum, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adolescence_unhealthy ~ QUIC_child_total + QUIC_Adolescence_total, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adolescence_unhealthy ~ QUIC_child_total + CHAOS_child_total + deprivation_child_total + threat_childhood_total, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adolescence_unhealthy ~ QUIC_Adolescence_total + CHAOS_Adolescence_total + deprivation_Adolescence_total + threat_adolescence_total, data=all_scored)
summary(m1)
m1t <- lm(HUMS_adolescence_unhealthy ~ QUIC_Adolescence_total + QUIC_child_total, data=all_scored)
summary(m1t)
m1 <- lm(HUMS_adolescence_unhealthy ~ QUIC_child_total + QUIC_Adolescence_total, data=all_scored)
summary(m1)
m2 <- lm(HUMS_adult_unhealthy ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m2)
m2 <- lm(HUMS_adult_unhealthy ~ QUIC_Adolescence_total + CHAOS_Adolescence_total + deprivation_Adolescence_total + threat_adolescence_total, data=all_scored)
summary(m2)
m2 <- lm(HUMS_adult_unhealthy ~ QUIC_child_total + CHAOS_child_total + deprivation_child_total + threat_childhood_total, data=all_scored)
summary(m2)
m1 <- lm(HUMS_adolescence_healthy ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adolescence_healthy ~ QUIC_Adolescence_total + CHAOS_Adolescence_total + deprivation_Adolescence_total + threat_adolescence_total, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adolescence_healthy ~ QUIC_child_total + CHAOS_child_total + deprivation_child_total + threat_childhood_total, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adult_healthy ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adult_healthy ~ QUIC_Adolescence_total + CHAOS_Adolescence_total + deprivation_Adolescence_total + threat_adolescence_total, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adult_healthy ~ QUIC_child_total + CHAOS_child_total + deprivation_child_total + threat_childhood_total, data=all_scored)
summary(m1)
t.test(anhedonics$MH_total, matched_controls$MH_total)
anhedonics <- matched_data %>%
subset(group=="Musical Anhedonics")
matched_controls <- matched_data %>%
subset(group=="Matched Controls")
t.test(anhedonics$MH_total, matched_controls$MH_total)
t.test(anhedonics$deprivation_sum, matched_controls$deprivation_sum)
t.test(anhedonics$deprivation_child_cognitive, matched_controls$deprivation_child_cognitive)
t.test(anhedonics$deprivation_Adolescence_cognitive, matched_controls$deprivation_Adolescence_cognitive)
t.test(anhedonics$QUIC_sum, matched_controls$QUIC_sum)
t.test(anhedonics$CHAOS_sum, matched_controls$CHAOS_sum)
t.test(anhedonics$Threat_sum, matched_controls$Threat_sum)
t.test(anhedonics$deprivation_Adolescence_emotional, matched_controls$deprivation_Adolescence_emotional)
m1 <- lm(MBEA_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
library(tidyverse)
library(lme4)
library(mediation)
library(lmerTest)
library(performance)
library(sjPlot)
install.packages("multilevelmediation")
library(boot)
scored_data <- read.csv(file="../data/pleasing-displeasing_followup/scored_data.csv")
master <- read.csv(file="../data/pleasing-displeasing_followup/pleasing_displeasing_scored.csv")
matched_data <- read.csv("../data/pleasing-displeasing_followup/matched_data.csv")
master <- master[-1]
names(master)[1] <- "ID"
names(master)[10:21] <- c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J','K','L')
names(master)[22:31] <-c('IADS105','IADS110','IADS220','IADS283','IADS351','IADS353',
'IADS423','IADS502','IADS717','IADS730')
names(master)[32:39] <- c('Envi1','Envi2','Envi3','Envi4','Envi5','Envi6','Envi7','Envi8')
just_ratings<-master[10:39] -4
cleaned <- cbind(master[1], just_ratings)
cleaned <- cbind(cleaned, master[267])
derived <- cleaned[1:13]
derivedstims <- pivot_longer(derived, A:L, names_to = "stim_name", values_to = "rating" )
IADS <- cleaned[14:23]
IADS <- cbind(cleaned[1], IADS)
IADS <- cbind(cleaned[32], IADS)
IADS_stims <- pivot_longer(IADS, IADS105:IADS730, names_to = "stim_name", values_to = "rating" )
envi <- just_ratings[23:30]
envi <- cbind(cleaned[1], envi)
envi_stims <- pivot_longer(envi, Envi1:Envi8, names_to = "stim_name", values_to = "rating" )
#changing stim names for pleasing/displeasing comparisons
names(derived)[2:13] <- c("Displeasing1", "Displeasing2", "Pleasing3","Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Pleasing10", "Pleasing11", "Displeasing12")
derived_plsdispls <- pivot_longer(derived, !ID, names_to = "soundID", values_to = "rating" )
derived_plsdispls$stim_name <- gsub("[0-9]", "", derived_plsdispls$soundID)
names(IADS)[3:12] <- c("Displeasing1", "Pleasing2", "Pleasing3", "Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Displeasing10")
IADS_plsdispls <- pivot_longer(IADS, !PASS_total:ID, names_to = "soundID", values_to = "rating")
IADS_plsdispls$stim_name <- gsub("[0-9]", "", IADS_plsdispls$soundID)
names(envi)[2:9] <- c("Displeasing1", "Displeasing2", "Pleasing3", "Pleasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8")
envi_plsdispls <- pivot_longer(envi, !ID, names_to = "soundID", values_to = "rating")
envi_plsdispls$stim_name <- gsub("[0-9]", "", envi_plsdispls$soundID)
names(scored_data)[20] <- "ID"
names(matched_data)[3] <- "ID"
all_scored <- merge(master, scored_data, by.x="ID", by.y="ID")
digital <-merge(derived_plsdispls, scored_data, by.x="ID", by.y="ID")
digital_pleasing <- subset(digital, stim_name=="Pleasing")
digital_displeasing <- subset(digital, stim_name=="Displeasing")
IADS<-merge(IADS_plsdispls, scored_data, by.x="ID", by.y="ID")
IADS_pleasing <- subset(IADS, stim_name=="Pleasing")
IADS_displeasing <- subset(IADS, stim_name=="Displeasing")
envi <- merge(envi_plsdispls, scored_data, by.x="ID", by.y="ID")
envi_pleasing <- subset(envi, stim_name=="Pleasing")
envi_displeasing <- subset(envi, stim_name=="Displeasing")
matched_data <- merge(matched_data, scored_data, by.x="ID", by.y="ID")
write.csv(all_scored, "../data/all_scored.csv")
cor.test(all_scored$CHAOS_child_total, all_scored$MBEA_total)
m1 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PASS_total + (1 | ID) + (1 | soundID), data=digital_pleasing)
m1 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PAS_total + (1 | ID) + (1 | soundID), data=digital_pleasing)
View(digital_pleasing)
merge(digital_pleasing, all_scored)
View(all_scored)
View(digital_pleasing)
View(all_scored)
View(master)
m1 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PAS_total + (1 | ID) + (1 | soundID), data=digital_pleasing)
m1 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PASS_total + (1 | ID) + (1 | soundID), data=digital_pleasing)
View(digital_pleasing)
View(all_scored)
all_scored <- merge(master, scored_data, by.x="ID", by.y="ID")
digital <-merge(derived_plsdispls, all_scored, by.x="ID", by.y="ID")
digital_pleasing <- subset(digital, stim_name=="Pleasing")
digital_displeasing <- subset(digital, stim_name=="Displeasing")
IADS<-merge(IADS_plsdispls, all_scored, by.x="ID", by.y="ID")
IADS_pleasing <- subset(IADS, all_scored=="Pleasing")
IADS_displeasing <- subset(IADS, stim_name=="Displeasing")
envi <- merge(envi_plsdispls, all_scored, by.x="ID", by.y="ID")
envi_pleasing <- subset(envi, stim_name=="Pleasing")
envi_displeasing <- subset(envi, stim_name=="Displeasing")
matched_data <- merge(matched_data, all_scored, by.x="ID", by.y="ID")
write.csv(all_scored, "../data/all_scored.csv")
m1 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PASS_total + (1 | ID) + (1 | soundID), data=digital_pleasing)
#multicollinearity checks
check_collinearity(m1)
#multicollinearity checks
check_collinearity(m1)
summary(m1)
m2 <- lmer(scale(rating) ~ scale(QUIC_sum) + scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum) + PASS_total + (1 | ID) + (1 | soundID), data=digital_displeasing)
summary(m2)
m2 <- lmer(scale(rating) ~ scale(QUIC_sum) + scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum) + scale(PASS_total) + (1 | ID) + (1 | soundID), data=digital_displeasing)
summary(m2)
m1 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + STAI_total + (1 | ID) + (1 | soundID), data=digital_pleasing)
#multicollinearity checks
check_collinearity(m1)
summary(m1)
m2 <- lmer(scale(rating) ~ scale(QUIC_sum) + scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum) + scale(STAI_total) + (1 | ID) + (1 | soundID), data=digital_displeasing)
summary(m2)
#timing follow-up
m2t <- lmer(rating ~ CHAOS_Adolescence_total + CHAOS_child_total + PASS_total + (1 | ID) + (1 | soundID), data=digital_displeasing)
summary(m2t)
#timing follow-up
m2t <- lmer(rating ~ CHAOS_Adolescence_total + CHAOS_child_total + (1 | ID) + (1 | soundID), data=digital_displeasing)
check_collinearity(m2t)
summary(m2t)
m2 <- lmer(scale(rating) ~ scale(QUIC_sum) + scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum) + scale(STAI_total) + (1 | ID) + (1 | soundID), data=digital_displeasing)
m2 <- lmer(scale(rating) ~ scale(QUIC_sum) + scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum) + scale(STAI_total) + (1 | ID) + (1 | soundID), data=digital_displeasing)
m2 <- lmer(scale(rating) ~ scale(QUIC_sum) + scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum) + scale(STAI_total) + (1 | ID) + (1 | soundID), data=digital_displeasing)
summary(m2)
#timing follow-up
m2t <- lmer(rating ~ CHAOS_Adolescence_total + CHAOS_child_total + STAI_total +(1 | ID) + (1 | soundID), data=digital_displeasing)
check_collinearity(m2t)
summary(m2t)
#timing follow-up
m2t <- lmer(rating ~ CHAOS_Adolescence_total + CHAOS_child_total + PASS_total +(1 | ID) + (1 | soundID), data=digital_displeasing)
check_collinearity(m2t)
summary(m2t)
library(tidyverse)
library(lmerTest)
library(MuMIn)
library(AICcmodavg)
library(sjPlot)
library(corrplot)
library(psych)
#UPDATE THIS FOR A BETTER PIPELINE
all_scored <- read.csv('../data/all_scored.csv')
variables = dplyr::select(all_scored,
MBEA_total, BAT_total,
QUIC_sum,
CHAOS_sum, deprivation_sum, Threat_sum)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Sum", "CHAOS Sum", "Deprivation Sum", "Threat Adolescence")
rownames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Sum", "CHAOS Sum", "Deprivation Sum", "Threat Adolescence")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
ariables = dplyr::select(all_scored,
MBEA_total, BAT_total,
QUIC_sum,
CHAOS_sum, deprivation_sum, Threat_sum)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Sum", "CHAOS Sum", "Deprivation Sum", "Threat Sum")
rownames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Sum", "CHAOS Sum", "Deprivation Sum", "Threat Sum")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
cor.test(all_scored$MBEA_total, all_scored$QUIC_sum)
cor.test(all_scored$MBEA_total, all_scored$CHAOS_sum)
variables = dplyr::select(all_scored,
MBEA_total, BAT_total,
QUIC_sum,
CHAOS_sum, deprivation_sum, Threat_sum)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Sum", "CHAOS Sum", "Deprivation Sum", "Threat Sum")
rownames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Sum", "CHAOS Sum", "Deprivation Sum", "Threat Sum")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
cor.test(all_scored$Gold_perceptualabilities, all_scored$CHAOS_sum)
cor.test(all_scored$Gold_perceptualabilities, all_scored$QUIC_sum)
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
variables = dplyr::select(all_scored,
MBEA_total, BAT_total,
QUIC_child_total,
CHAOS_child_total, deprivation_child_total, threat_childhood_total)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Childhood", "CHAOS Childhood", "Deprivation Childhood", "Threat Childhood")
rownames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Childhood", "CHAOS Childhood", "Deprivation Childhood", "Threat Childhood")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
variables = dplyr::select(all_scored,
MBEA_total, BAT_total,
QUIC_Adolescence_total,
CHAOS_Adolescence_total, deprivation_Adolescence_total, threat_adolescence_total)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Adolescence", "CHAOS Adolescence", "Deprivation Adolescence", "Threat Adolescence")
rownames(corr_matrix) <- c('MBEA Score', 'BAT Score', "QUIC Adolescence", "CHAOS Adolescence", "Deprivation Adolescence", "Threat Adolescence")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
library(tidyverse)
library(lme4)
library(mediation)
library(lmerTest)
library(performance)
library(sjPlot)
install.packages("multilevelmediation")
library(boot)
scored_data <- read.csv(file="../data/pleasing-displeasing_followup/scored_data.csv")
master <- read.csv(file="../data/pleasing-displeasing_followup/pleasing_displeasing_scored.csv")
matched_data <- read.csv("../data/pleasing-displeasing_followup/matched_data.csv")
master <- master[-1]
names(master)[1] <- "ID"
names(master)[10:21] <- c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J','K','L')
names(master)[22:31] <-c('IADS105','IADS110','IADS220','IADS283','IADS351','IADS353',
'IADS423','IADS502','IADS717','IADS730')
names(master)[32:39] <- c('Envi1','Envi2','Envi3','Envi4','Envi5','Envi6','Envi7','Envi8')
just_ratings<-master[10:39] -4
cleaned <- cbind(master[1], just_ratings)
cleaned <- cbind(cleaned, master[267])
derived <- cleaned[1:13]
derivedstims <- pivot_longer(derived, A:L, names_to = "stim_name", values_to = "rating" )
IADS <- cleaned[14:23]
IADS <- cbind(cleaned[1], IADS)
IADS <- cbind(cleaned[32], IADS)
IADS_stims <- pivot_longer(IADS, IADS105:IADS730, names_to = "stim_name", values_to = "rating" )
envi <- just_ratings[23:30]
envi <- cbind(cleaned[1], envi)
envi_stims <- pivot_longer(envi, Envi1:Envi8, names_to = "stim_name", values_to = "rating" )
#changing stim names for pleasing/displeasing comparisons
names(derived)[2:13] <- c("Displeasing1", "Displeasing2", "Pleasing3","Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Pleasing10", "Pleasing11", "Displeasing12")
derived_plsdispls <- pivot_longer(derived, !ID, names_to = "soundID", values_to = "rating" )
derived_plsdispls$stim_name <- gsub("[0-9]", "", derived_plsdispls$soundID)
names(IADS)[3:12] <- c("Displeasing1", "Pleasing2", "Pleasing3", "Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Displeasing10")
IADS_plsdispls <- pivot_longer(IADS, !PASS_total:ID, names_to = "soundID", values_to = "rating")
IADS_plsdispls$stim_name <- gsub("[0-9]", "", IADS_plsdispls$soundID)
names(envi)[2:9] <- c("Displeasing1", "Displeasing2", "Pleasing3", "Pleasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8")
envi_plsdispls <- pivot_longer(envi, !ID, names_to = "soundID", values_to = "rating")
envi_plsdispls$stim_name <- gsub("[0-9]", "", envi_plsdispls$soundID)
names(scored_data)[20] <- "ID"
names(matched_data)[3] <- "ID"
all_scored <- merge(master, scored_data, by.x="ID", by.y="ID")
digital <-merge(derived_plsdispls, all_scored, by.x="ID", by.y="ID")
digital_pleasing <- subset(digital, stim_name=="Pleasing")
digital_displeasing <- subset(digital, stim_name=="Displeasing")
IADS<-merge(IADS_plsdispls, all_scored, by.x="ID", by.y="ID")
IADS_pleasing <- subset(IADS, stim_name=="Pleasing")
names(IADS_pleasing)[2] <-"PASS_total"
IADS_displeasing <- subset(IADS, stim_name=="Displeasing")
envi <- merge(envi_plsdispls, all_scored, by.x="ID", by.y="ID")
envi_pleasing <- subset(envi, stim_name=="Pleasing")
envi_displeasing <- subset(envi, stim_name=="Displeasing")
matched_data <- merge(matched_data, all_scored, by.x="ID", by.y="ID")
write.csv(all_scored, "../data/all_scored.csv")
m1 <- lm(MBEA_total ~ CHAOS_child_total + threat_childhood_total + deprivation_child_total + QUIC_child_total + PASS_total + Gold_musicaltraining, data=all_scored)
summary(m1)
m1 <- lm(MBEA_total ~ CHAOS_child_total + CHAOS_Adolescence_total + PASS_total + Gold_musicaltraining, data=all_scored)
summary(m1)
cor.test(all_scored$STAI_total, all_scored$PASS_total)
## updated streamline
#CHAOS childhood negative correlation
m1 <- lm(MBEA_total ~ CHAOS_child_total + threat_childhood_total + deprivation_child_total + QUIC_child_total + PASS_total +STAI_total + Gold_musicaltraining, data=all_scored)
check_collinearity(m1)
summary(m1)
m1 <- lm(MBEA_total ~ CHAOS_child_total + CHAOS_Adolescence_total + PASS_total + STAI_total + Gold_musicaltraining, data=all_scored)
summary(m1)
#Threat adolescent positive correlation
m1 <- lm(MBEA_total ~  CHAOS_Adolescence_total + threat_adolescence_total + deprivation_Adolescence_total + QUIC_Adolescence_total + PASS_total + STAI_total + Gold_musicaltraining, data=all_scored)
summary(m1)
cor.test(all_scored$CHAOS_Adolescence_total, all_scored$threat_adolescence_total)
m1 <- lm(MBEA_total ~ CHAOS_child_total + CHAOS_Adolescence_total + PASS_total + STAI_total + Gold_musicaltraining, data=all_scored)
summary(m1)
cor.test(all_scored$CHAOS_Adolescence_total, all_scored$CHAOS_child_total)
m1 <- lm(MBEA_total ~ CHAOS_child_total + CHAOS_Adolescence_total + PASS_total + STAI_total + Gold_musicaltraining, data=all_scored)
check_collinearity(m1)
m1 <- lm(MBEA_total ~ CHAOS_child_total + CHAOS_Adolescence_total + threat_adolescence_total + threat_childhood_total + PASS_total + STAI_total + Gold_musicaltraining, data=all_scored)
summary(m1)
check_collinearity(m1)
cor.test(all_scored$threat_adolescence_total, all_scored$threat_childhood_total)
m1 <- lm(MBEA_total ~ CHAOS_child_total + threat_childhood_total + deprivation_child_total + QUIC_child_total + PASS_total +STAI_total + Gold_musicaltraining, data=all_scored)
check_collinearity(m1
check_collinearity(m1)
m1 <- lm(MBEA_total ~ CHAOS_child_total + threat_childhood_total + deprivation_child_total + QUIC_child_total + PASS_total +STAI_total + Gold_musicaltraining, data=all_scored)
check_collinearity(m1)
m1 <- lm(MBEA_total ~ CHAOS_child_total + CHAOS_Adolescence_total + threat_adolescence_total + threat_childhood_total + PASS_total + STAI_total + Gold_musicaltraining, data=all_scored)
summary(m1)
check_collinearity(m1)
m1 <- lm(BAT_total ~  CHAOS_Adolescence_total + threat_adolescence_total + deprivation_Adolescence_total + QUIC_Adolescence_total + PASS_total + STAI_total + Gold_musicaltraining, data=all_scored)
summary(m1)
m1 <- lm(BAT_total ~  CHAOS_Adolescence_total + threat_adolescence_total + deprivation_Adolescence_total + QUIC_Adolescence_total + PASS_total + Gold_musicaltraining, data=all_scored)
summary(m1)
m1 <- lm(BAT_total ~    QUIC_Adolescence_total  + Gold_musicaltraining, data=all_scored)
m1 <- lm(BAT_total ~    QUIC_Adolescence_total  + Gold_musicaltraining, data=all_scored)
summary(m1)
m1 <- lm(BAT_total ~ QUIC_Adolescence_total + PASS_total + STAI_total + Gold_musicaltraining, data=all_scored)
summary(m1)
m1 <- lm(BAT_total ~  CHAOS_Adolescence_total + threat_adolescence_total + deprivation_Adolescence_total + QUIC_Adolescence_total, data=all_scored)
summary(m1)
m1 <- lm(BAT_total ~ STAI_total + Gold_musicaltraining, data=all_scored)
summary(m1)
cor.test(all_scored$QUIC_Adolescence_total, all_scored$STAI_total)
