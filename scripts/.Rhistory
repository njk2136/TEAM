CHAOS_Adolescence <- survey %>%
select("CHAOS_Adolescence_1_1":"CHAOS_Adolescence_6_1")
cols_reverse <- c("CHAOS_Adolescence_1_1", "CHAOS_Adolescence_5_1", "CHAOS_Adolescence_6_1")
# Reverse code
CHAOS_Adolescence[cols_reverse] <- lapply(CHAOS_Adolescence[cols_reverse], reverseCode, min=1, max=5)
survey$CHAOS_Adolescence_total <- apply(CHAOS_Adolescence,1, sum)
hist(survey$CHAOS_Adolescence_total)
cor.test(survey$CHAOS_child_total, survey$CHAOS_Adolescence_total)
ggplot(data=survey, aes(x=CHAOS_child_total, y=CHAOS_Adolescence_total)) + geom_point()
survey$CHAOS_sum <- survey$CHAOS_child_total + survey$CHAOS_Adolescence_total
### CHILDHOOD ###
#Deprivation Scoring
deprivation_child <- survey %>%
select("DT1c_1":"DT25c_1")
cols_reverse <- c("DT1c_1", "DT2c_1", "DT3c_1", "DT4c_1", "DT5c_1", "DT6c_1", "DT7c_1", "DT10c_1")
cols_emotionaldeprivation <- c("DT1c_1", "DT2c_1", "DT3c_1", "DT4c_1", "DT5c_1", "DT6c_1", "DT7c_1")
cols_physicaldeprivation <- c("DT10c_1", "DT11c_1", "DT12c_1", "DT13c_1", "DT14c_1", "DT15c_1", "DT16c_1", "DT17c_1")
cols_cognitivedeprivation <- c("DT18c_1", "DT19c_1", "DT20c_1", "DT21c_1", "DT22c_1", "DT23c_1", "DT24c_1", "DT25c_1")
# Reverse code
deprivation_child[cols_reverse] <- lapply(deprivation_child[cols_reverse], reverseCode, min=1, max=4)
#scoring
survey$deprivation_child_total <- apply(deprivation_child,1, sum)
survey$deprivation_child_emotional <- apply(deprivation_child[cols_emotionaldeprivation], 1,sum)
survey$deprivation_child_physical <- apply(deprivation_child[cols_physicaldeprivation], 1,sum)
survey$deprivation_child_cognitive <- apply(deprivation_child[cols_cognitivedeprivation], 1,sum)
hist(survey$deprivation_child_total)
### ADOLESCENCE ###
#Deprivation Scoring
deprivation_Adolescence <- survey %>%
select("DT1a_1":"DT25a_1")
cols_reverse <- c("DT1a_1", "DT2a_1", "DT3a_1", "DT4a_1", "DT5a_1", "DT6a_1", "DT7a_1", "DT10a_1")
cols_emotionaldeprivation <- c("DT1a_1", "DT2a_1", "DT3a_1", "DT4a_1", "DT5a_1", "DT6a_1", "DT7a_1")
cols_physicaldeprivation <- c("DT10a_1", "DT11a_1", "DT12a_1", "DT13a_1", "DT14a_1", "DT15a_1", "DT16a_1", "DT17a_1")
cols_cognitivedeprivation <- c("DT18a_1", "DT19a_1", "DT20a_1", "DT21a_1", "DT22a_1", "DT23a_1", "DT24a_1", "DT25a_1")
# Reverse code
deprivation_Adolescence[cols_reverse] <- lapply(deprivation_Adolescence[cols_reverse], reverseCode, min=1, max=4)
#scoring
survey$deprivation_Adolescence_total <- apply(deprivation_Adolescence,1, sum)
survey$deprivation_Adolescence_emotional <- apply(deprivation_Adolescence[cols_emotionaldeprivation], 1,sum)
survey$deprivation_Adolescence_physical <- apply(deprivation_Adolescence[cols_physicaldeprivation], 1,sum)
survey$deprivation_Adolescence_cognitive <- apply(deprivation_Adolescence[cols_cognitivedeprivation], 1,sum)
hist(survey$deprivation_Adolescence_total)
cor.test(survey$deprivation_child_total, survey$CHAOS_child_total)
survey$deprivation_sum <- survey$deprivation_child_total + survey$deprivation_Adolescence_total
### CHILDHOOD ###
#Threat Scoring
threat_child <- survey %>%
select("T1c_1":"T2.8c_1")
cols_home_threat <- c("T1c_1","T2c_1","T3c_1","T4c_1","T5c_1","T6c_1","T7c_1","T8c_1","T9c_1","T10c_1","T11c_1","T12c_1")
cols_neighborhood_threat <- c("T2.1c_1","T2.2c_1","T2.3c_1","T2.4c_1","T2.5c_1","T2.6c_1","T2.7c_1","T2.8c_1")
survey$threat_childhood_total <- apply(threat_child,1, sum)
survey$threat_childhood_home <- apply(threat_child[cols_home_threat], 1,sum)
survey$threat_childhood_neighborhood <- apply(threat_child[cols_neighborhood_threat], 1,sum)
hist(survey$threat_childhood_total)
### ADOLESCENCE ###
#Threat Scoring
threat_adolescence <- survey %>%
select("T1a_1":"T2.8a_1")
cols_home_threat <- c("T1a_1","T2a_1","T3a_1","T4a_1","T5a_1","T6a_1","T7a_1","T8a_1","T9a_1","T10a_1","T11a_1","T12a_1")
cols_neighborhood_threat <- c("T2.1a_1","T2.2a_1","T2.3a_1","T2.4a_1","T2.5a_1","T2.6a_1","T2.7a_1","T2.8a_1")
survey$threat_adolescence_total <- apply(threat_adolescence,1, sum)
survey$threat_adolescence_home <- apply(threat_adolescence[cols_home_threat], 1,sum)
survey$threat_adolescence_neighborhood <- apply(threat_adolescence[cols_neighborhood_threat], 1,sum)
hist(survey$threat_adolescence_total)
ggplot(data=survey, aes(x=threat_childhood_total, y=threat_adolescence_total)) + geom_point()+
geom_smooth()
survey$Threat_sum <- survey$threat_childhood_total + survey$threat_adolescence_total
#isolate survey you're scoring
STAI <- survey %>%
select("STAI1_1":"STAI20_1")
#if it is a simple subscore (i.e. no reverse coding or anything)
survey$STAI_total <- apply(STAI,1, sum)
write.csv(file='../data/pleasing-displeasing_followup/scored_data.csv', survey)
library(tidyverse)
library(lme4)
library(lmerTest)
scored_data <- read.csv(file="../data/pleasing-displeasing_followup/scored_data.csv")
master <- read.csv(file="../data/pleasing-displeasing_followup/pleasing_displeasing_scored.csv")
master <- master[-1]
names(master)[1] <- "ID"
names(master)[10:21] <- c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J','K','L')
names(master)[22:31] <-c('IADS105','IADS110','IADS220','IADS283','IADS351','IADS353',
'IADS423','IADS502','IADS717','IADS730')
names(master)[32:39] <- c('Envi1','Envi2','Envi3','Envi4','Envi5','Envi6','Envi7','Envi8')
just_ratings<-master[10:39] -4
cleaned <- cbind(master[1], just_ratings)
derived <- cleaned[1:13]
derivedstims <- pivot_longer(derived, A:L, names_to = "stim_name", values_to = "rating" )
IADS <- cleaned[14:23]
IADS <- cbind(cleaned[1], IADS)
IADS_stims <- pivot_longer(IADS, IADS105:IADS730, names_to = "stim_name", values_to = "rating" )
envi <- just_ratings[23:30]
envi <- cbind(cleaned[1], envi)
envi_stims <- pivot_longer(envi, Envi1:Envi8, names_to = "stim_name", values_to = "rating" )
#changing stim names for pleasing/displeasing comparisons
names(derived)[2:13] <- c("Displeasing1", "Displeasing2", "Pleasing3","Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Pleasing10", "Pleasing11", "Displeasing12")
derived_plsdispls <- pivot_longer(derived, !ID, names_to = "soundID", values_to = "rating" )
derived_plsdispls$stim_name <- gsub("[0-9]", "", derived_plsdispls$soundID)
names(IADS)[2:11] <- c("Displeasing1", "Pleasing2", "Pleasing3", "Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Displeasing10")
IADS_plsdispls <- pivot_longer(IADS, !ID, names_to = "soundID", values_to = "rating")
IADS_plsdispls$stim_name <- gsub("[0-9]", "", IADS_plsdispls$soundID)
names(envi)[2:9] <- c("Displeasing1", "Displeasing2", "Pleasing3", "Pleasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8")
envi_plsdispls <- pivot_longer(envi, !ID, names_to = "soundID", values_to = "rating")
envi_plsdispls$stim_name <- gsub("[0-9]", "", envi_plsdispls$soundID)
View(scored_data)
names(scored_data)[5] <- "ID"
all_scored <- merge(master, scored_data, by.x="ID", by.y="ID")
digital <-merge(derived_plsdispls, scored_data, by.x="ID", by.y="ID")
digital_pleasing <- subset(digital, stim_name=="Pleasing")
digital_displeasing <- subset(digital, stim_name="Displeasing")
IADS<-merge(IADS_plsdispls, scored_data, by.x="ID", by.y="ID")
IADS_pleasing <- subset(IADS, stim_name=="Pleasing")
IADS_displeasing <- subset(IADS, stim_name="Displeasing")
m1 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + (1 | ID) + (1 | soundID), data=digital_pleasing)
summary(m1)
m2 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + (1 | ID) + (1 | soundID), data=digital_displeasing)
summary(m2)
m3 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + (1 | ID) + (1 | soundID), data=IADS_pleasing)
summary(m3)
#timing follow-up
m3t <- lmer(rating ~ Threat_child_total + Threat_Adolescence_total + (1 | ID) + (1 | soundID), data=IADS_pleasing)
#timing follow-up
m3t <- lmer(rating ~ Threat_childhood_total + Threat_Adolescence_total + (1 | ID) + (1 | soundID), data=IADS_pleasing)
#timing follow-up
m3t <- lmer(rating ~ threat_childhood_total + Threat_Adolescence_total + (1 | ID) + (1 | soundID), data=IADS_pleasing)
#timing follow-up
m3t <- lmer(rating ~ threat_childhood_total + threat_Adolescence_total + (1 | ID) + (1 | soundID), data=IADS_pleasing)
#timing follow-up
m3t <- lmer(rating ~ threat_childhood_total + threat_adolescence_total + (1 | ID) + (1 | soundID), data=IADS_pleasing)
summary(m3t)
m4 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + (1 | ID) + (1 | soundID), data=IADS_displeasing)
summary(m4)
#timing follow-up
m4t <- lmer(rating ~ threat_childhood_total + threat_adolescence_total + (1 | ID) + (1 | soundID), data=IADS_pleasing)
#timing follow-up
m4t <- lmer(rating ~ threat_childhood_total + threat_adolescence_total + (1 | ID) + (1 | soundID), data=IADS_displeasing)
summary(m4)
summary(m4t)
#timing follow-up
m4t <- lmer(rating ~ threat_childhood_total + threat_adolescence_total + (1 | ID) + (1 | soundID), data=IADS_displeasing)
#timing follow-up
m4t <- lmer(rating ~ threat_childhood_home + threat_adolescence_home + (1 | ID) + (1 | soundID), data=IADS_displeasing)
summary(m4t)
#timing follow-up
m4t <- lmer(rating ~ threat_childhood_neighborhood + threat_adolescence_neighborhood + (1 | ID) + (1 | soundID), data=IADS_displeasing)
summary(m4t)
summary(m4t)
summary(m4)
m1 <- lm(MBEA_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
#timing follow-up
m1t <- lm(MBEA_total ~ CHAOS_childhood + CHAOS_adolescence)
#timing follow-up
m1t <- lm(MBEA_total ~ CHAOS_childhood + CHAOS_adolescence, data=all_scored)
#timing follow-up
m1t <- lm(MBEA_total ~ CHAOS_child_total + CHAOS_Adolescence_total, data=all_scored)
summary(m1t)
#timing follow-up
m1t <- lm(MBEA_total ~ CHAOS_child_total + CHAOS_Adolescence_total, data=all_scored)
summary(m1t)
summary(m1)
m2 <- lm(BAT_total ~  QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m2)
#timing follow-up
m2t <- lm(BAT_total ~ QUIC_child_total + QUIC_Adolescence_total, data=all_scored)
summary(m2t)
summary(m2)
m1 <- lm(BMRQ_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
#timing
m2t <- lm(BMRQ_total ~ QUIC_child_total + QUIC_Adolescence_total, data=all_scored)
summary(m2t)
#timing
m2t <- lm(BMRQ_total ~ CHAOS_child_total + CHAOS_Adolescence_total, data=all_scored)
summary(m2t)
#timing follow-up
m2t <- lm(BAT_total ~ QUIC_child_total + QUIC_Adolescence_total, data=all_scored)
summary(m2t)
#timing
m2t <- lm(BMRQ_total ~ CHAOS_child_total + CHAOS_Adolescence_total, data=all_scored)
summary(m2t)
#timing
m2t <- lm(BMRQ_total ~ deprivation_child_total + deprivation_Adolescence_total, data=all_scored)
summary(m2t)
#timing
m2t <- lm(BMRQ_total ~ Threat_child_total + Threat_Adolescence_total, data=all_scored)
#timing
m2t <- lm(BMRQ_total ~ threat_child_total + threat_Adolescence_total, data=all_scored)
#timing
m2t <- lm(BMRQ_total ~ threat_childhood_total + threat_Adolescence_total, data=all_scored)
#timing
m2t <- lm(BMRQ_total ~ threat_childhood_total + threat_adolescence_total, data=all_scored)
summary(m2t)
install.packages("mediate")
install.packages("mediation")
library(mediation)
m3 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + (1 | ID) + (1 | soundID), data=IADS_pleasing)
summary(m3)
#mediation follow-up
m3m <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PASS_total (1 | ID) + (1 | soundID), data=IADS_pleasing)
#mediation follow-up
m3m <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PASS_total + (1 | ID) + (1 | soundID), data=IADS_pleasing)
View(IADS_pleasing)
#mediation follow-up
m3m <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + STAI_total + (1 | ID) + (1 | soundID), data=IADS_displeasing)
summary(m3m)
#mediation follow-up
m4m <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + STAI_total + (1 | ID) + (1 | soundID), data=IADS_displeasing)
summary(m3m)
summary(m4m)
mediate(m4,m4m boot=TRUE)
mediate(m4,m4m,boot=TRUE)
mediate(m4,m4m)
#mediation follow-up
m4m <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + STAI_total + (1 | ID), data=IADS_displeasing)
summary(m4m)
m4 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + (1 | ID), data=IADS_displeasing)
summary(m4)
mediate(m4,m4m)
m4 <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + (1 | ID), data=IADS_displeasing)
summary(m4)
#mediation follow-up
m4m <- lmer(rating ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + STAI_total + (1 | ID), data=IADS_displeasing)
summary(m4m)
mediate(m4,m4m)
mediate(m4,m4m, boot=TRUE)
library(tidyverse)
source("reverseCode.R")
survey <- read.csv(file="../data/pleasing-displeasing_followup/Displeasing)_October 23, 2022_08.27.csv")
### CHILDHOOD ###
#QUIC Scoring
QUIC_child <- survey %>%
select("QUIC_Child_2":"QUIC_Child_38")
library(tidyverse)
source("reverseCode.R")
survey <- read.csv(file="../data/pleasing-displeasing_followup/Displeasing)_October 23, 2022_08.27.csv")
### CHILDHOOD ###
#QUIC Scoring
QUIC_child <- survey %>%
select("QUIC_Child_2":"QUIC_Child_38")
### CHILDHOOD ###
#CHAOS Scoring
CHAOS_child <- survey %>%
select("CHAOS_Child_1_1":"CHAOS_Child_6_1")
library(tidyverse)
source("reverseCode.R")
survey <- read.csv(file="../data/pleasing-displeasing_followup/Displeasing)_October 23, 2022_08.27.csv")
### CHILDHOOD ###
#QUIC Scoring
QUIC_child <- survey %>%
select("QUIC_Child_2":"QUIC_Child_38")
library(tidyverse)
source("reverseCode.R")
survey <- read.csv(file="../data/pleasing-displeasing_followup/Displeasing)_October 23, 2022_08.27.csv")
### CHILDHOOD ###
#QUIC Scoring
QUIC_child <- survey %>%
select("QUIC_Child_2":"QUIC_Child_38")
#recode verbal responses (if not numbers)
QUIC_child[QUIC_child == "Yes"] <- as.numeric(1)
QUIC_child[QUIC_child == "No"] <- as.numeric(0)
QUIC_child[1:22] <- as.numeric(unlist(QUIC_child[1:22]))
cols_reverse <- c("QUIC_Child_8", "QUIC_Child_15", "QUIC_Child_17", "QUIC_Child_36")
cols_parentalpredictability <- c("QUIC_Child_2", "QUIC_Child_8","QUIC_Child_11", "QUIC_Child_12", "QUIC_Child_15","QUIC_Child_16", "QUIC_Child_17","QUIC_Child_31","QUIC_Child_32","QUIC_Child_33", "QUIC_Child_34","QUIC_Child_35")
cols_physiscalenvironment <- c("QUIC_Child_13", "QUIC_Child_20",  "QUIC_Child_26", "QUIC_Child_27", "QUIC_Child_36", "QUIC_Child_37", "QUIC_Child_38")
cols_safetyandsecurity <- c("QUIC_Child_23", "QUIC_Child_24", "QUIC_Child_25")
# Reverse code
QUIC_child[cols_reverse] <- lapply(QUIC_child[cols_reverse], reverseCode, min=0, max=1)
#scoring
survey$QUIC_child_total <- apply(QUIC_child,1, sum)
survey$QUIC_child_parentalpredictability <- apply(QUIC_child[cols_parentalpredictability], 1,sum)
survey$QUIC_child_physiscalenvironment <- apply(QUIC_child[cols_physiscalenvironment], 1,sum)
survey$QUIC_child_safetyandsecurity <- apply(QUIC_child[cols_safetyandsecurity], 1,sum)
hist(survey$QUIC_child_total)
### ADOLESCENCE ###
#QUIC Scoring
QUIC_Adolescence <- survey %>%
select("QUIC_Adolescence_2":"QUIC_Adolescence_38")
#recode verbal responses (if not numbers)
QUIC_Adolescence[QUIC_Adolescence == "Yes"] <- as.numeric(1)
QUIC_Adolescence[QUIC_Adolescence == "No"] <- as.numeric(0)
QUIC_Adolescence[1:22] <- as.numeric(unlist(QUIC_Adolescence[1:22]))
cols_reverse <- c("QUIC_Adolescence_8", "QUIC_Adolescence_15", "QUIC_Adolescence_17", "QUIC_Adolescence_36")
cols_parentalpredictability <- c("QUIC_Adolescence_2", "QUIC_Adolescence_8","QUIC_Adolescence_11", "QUIC_Adolescence_12", "QUIC_Adolescence_15","QUIC_Adolescence_16", "QUIC_Adolescence_17","QUIC_Adolescence_31","QUIC_Adolescence_32","QUIC_Adolescence_33", "QUIC_Adolescence_34","QUIC_Adolescence_35")
cols_physiscalenvironment <- c("QUIC_Adolescence_13", "QUIC_Adolescence_20",  "QUIC_Adolescence_26", "QUIC_Adolescence_27", "QUIC_Adolescence_36", "QUIC_Adolescence_37", "QUIC_Adolescence_38")
cols_safetyandsecurity <- c("QUIC_Adolescence_23", "QUIC_Adolescence_24", "QUIC_Adolescence_25")
# Reverse code
QUIC_Adolescence[cols_reverse] <- lapply(QUIC_Adolescence[cols_reverse], reverseCode, min=0, max=1)
#scoring
survey$QUIC_Adolescence_total <- apply(QUIC_Adolescence,1, sum)
survey$QUIC_Adolescence_parentalpredictability <- apply(QUIC_Adolescence[cols_parentalpredictability], 1,sum)
survey$QUIC_Adolescence_physiscalenvironment <- apply(QUIC_Adolescence[cols_physiscalenvironment], 1,sum)
survey$QUIC_Adolescence_safetyandsecurity <- apply(QUIC_Adolescence[cols_safetyandsecurity], 1,sum)
hist(survey$QUIC_Adolescence_total)
cor.test(survey$QUIC_child_total, survey$QUIC_Adolescence_total)
ggplot(data=survey, aes(x=QUIC_child_total, y=QUIC_Adolescence_total)) + geom_point()
survey$QUIC_sum <- survey$QUIC_child_total + survey$QUIC_Adolescence_total
### CHILDHOOD ###
#CHAOS Scoring
CHAOS_child <- survey %>%
select("CHAOS_Child_1_1":"CHAOS_Child_6_1")
cols_reverse <- c("CHAOS_Child_1_1", "CHAOS_Child_5_1", "CHAOS_Child_6_1")
# Reverse code
CHAOS_child[cols_reverse] <- lapply(CHAOS_child[cols_reverse], reverseCode, min=1, max=5)
survey$CHAOS_child_total <- apply(CHAOS_child,1, sum)
hist(survey$CHAOS_child_total)
### ADOLESCENCE ###
#CHAOS Scoring
CHAOS_Adolescence <- survey %>%
select("CHAOS_Adolescence_1_1":"CHAOS_Adolescence_6_1")
cols_reverse <- c("CHAOS_Adolescence_1_1", "CHAOS_Adolescence_5_1", "CHAOS_Adolescence_6_1")
# Reverse code
CHAOS_Adolescence[cols_reverse] <- lapply(CHAOS_Adolescence[cols_reverse], reverseCode, min=1, max=5)
survey$CHAOS_Adolescence_total <- apply(CHAOS_Adolescence,1, sum)
hist(survey$CHAOS_Adolescence_total)
cor.test(survey$CHAOS_child_total, survey$CHAOS_Adolescence_total)
ggplot(data=survey, aes(x=CHAOS_child_total, y=CHAOS_Adolescence_total)) + geom_point()
survey$CHAOS_sum <- survey$CHAOS_child_total + survey$CHAOS_Adolescence_total
### CHILDHOOD ###
#Deprivation Scoring
deprivation_child <- survey %>%
select("DT1c_1":"DT25c_1")
cols_reverse <- c("DT1c_1", "DT2c_1", "DT3c_1", "DT4c_1", "DT5c_1", "DT6c_1", "DT7c_1", "DT10c_1")
cols_emotionaldeprivation <- c("DT1c_1", "DT2c_1", "DT3c_1", "DT4c_1", "DT5c_1", "DT6c_1", "DT7c_1")
cols_physicaldeprivation <- c("DT10c_1", "DT11c_1", "DT12c_1", "DT13c_1", "DT14c_1", "DT15c_1", "DT16c_1", "DT17c_1")
cols_cognitivedeprivation <- c("DT18c_1", "DT19c_1", "DT20c_1", "DT21c_1", "DT22c_1", "DT23c_1", "DT24c_1", "DT25c_1")
# Reverse code
deprivation_child[cols_reverse] <- lapply(deprivation_child[cols_reverse], reverseCode, min=1, max=4)
#scoring
survey$deprivation_child_total <- apply(deprivation_child,1, sum)
survey$deprivation_child_emotional <- apply(deprivation_child[cols_emotionaldeprivation], 1,sum)
survey$deprivation_child_physical <- apply(deprivation_child[cols_physicaldeprivation], 1,sum)
survey$deprivation_child_cognitive <- apply(deprivation_child[cols_cognitivedeprivation], 1,sum)
hist(survey$deprivation_child_total)
### ADOLESCENCE ###
#Deprivation Scoring
deprivation_Adolescence <- survey %>%
select("DT1a_1":"DT25a_1")
cols_reverse <- c("DT1a_1", "DT2a_1", "DT3a_1", "DT4a_1", "DT5a_1", "DT6a_1", "DT7a_1", "DT10a_1")
cols_emotionaldeprivation <- c("DT1a_1", "DT2a_1", "DT3a_1", "DT4a_1", "DT5a_1", "DT6a_1", "DT7a_1")
cols_physicaldeprivation <- c("DT10a_1", "DT11a_1", "DT12a_1", "DT13a_1", "DT14a_1", "DT15a_1", "DT16a_1", "DT17a_1")
cols_cognitivedeprivation <- c("DT18a_1", "DT19a_1", "DT20a_1", "DT21a_1", "DT22a_1", "DT23a_1", "DT24a_1", "DT25a_1")
# Reverse code
deprivation_Adolescence[cols_reverse] <- lapply(deprivation_Adolescence[cols_reverse], reverseCode, min=1, max=4)
#scoring
survey$deprivation_Adolescence_total <- apply(deprivation_Adolescence,1, sum)
survey$deprivation_Adolescence_emotional <- apply(deprivation_Adolescence[cols_emotionaldeprivation], 1,sum)
survey$deprivation_Adolescence_physical <- apply(deprivation_Adolescence[cols_physicaldeprivation], 1,sum)
survey$deprivation_Adolescence_cognitive <- apply(deprivation_Adolescence[cols_cognitivedeprivation], 1,sum)
hist(survey$deprivation_Adolescence_total)
cor.test(survey$deprivation_child_total, survey$CHAOS_child_total)
survey$deprivation_sum <- survey$deprivation_child_total + survey$deprivation_Adolescence_total
### CHILDHOOD ###
#Threat Scoring
threat_child <- survey %>%
select("T1c_1":"T2.8c_1")
cols_home_threat <- c("T1c_1","T2c_1","T3c_1","T4c_1","T5c_1","T6c_1","T7c_1","T8c_1","T9c_1","T10c_1","T11c_1","T12c_1")
cols_neighborhood_threat <- c("T2.1c_1","T2.2c_1","T2.3c_1","T2.4c_1","T2.5c_1","T2.6c_1","T2.7c_1","T2.8c_1")
survey$threat_childhood_total <- apply(threat_child,1, sum)
survey$threat_childhood_home <- apply(threat_child[cols_home_threat], 1,sum)
survey$threat_childhood_neighborhood <- apply(threat_child[cols_neighborhood_threat], 1,sum)
hist(survey$threat_childhood_total)
### ADOLESCENCE ###
#Threat Scoring
threat_adolescence <- survey %>%
select("T1a_1":"T2.8a_1")
cols_home_threat <- c("T1a_1","T2a_1","T3a_1","T4a_1","T5a_1","T6a_1","T7a_1","T8a_1","T9a_1","T10a_1","T11a_1","T12a_1")
cols_neighborhood_threat <- c("T2.1a_1","T2.2a_1","T2.3a_1","T2.4a_1","T2.5a_1","T2.6a_1","T2.7a_1","T2.8a_1")
survey$threat_adolescence_total <- apply(threat_adolescence,1, sum)
survey$threat_adolescence_home <- apply(threat_adolescence[cols_home_threat], 1,sum)
survey$threat_adolescence_neighborhood <- apply(threat_adolescence[cols_neighborhood_threat], 1,sum)
hist(survey$threat_adolescence_total)
ggplot(data=survey, aes(x=threat_childhood_total, y=threat_adolescence_total)) + geom_point()+
geom_smooth()
survey$Threat_sum <- survey$threat_childhood_total + survey$threat_adolescence_total
View(survey)
cols_healthy <- c("HUMS_a3_1","HUMS_a5_1","HUMS_a6_1","HUMS_a9_1","HUMS_a13_1")
cols_unhealthy <- c("HUMS_a1_1","HUMS_a2_1","HUMS_a4_1","HUMS_a7_1","HUMS_a8_1","HUMS_a10_1","HUMS_a11_1","HUMS_a12_1")
survey$HUMS_adolescence_unhealthy <- apply(HUMS_adolescent[cols_unhealthy], 1,sum)
HUMS_adolescent <- survey %>%
select("HUMS_a1_1":"HUMS_a13_1")
cols_healthy <- c("HUMS_a3_1","HUMS_a5_1","HUMS_a6_1","HUMS_a9_1","HUMS_a13_1")
cols_unhealthy <- c("HUMS_a1_1","HUMS_a2_1","HUMS_a4_1","HUMS_a7_1","HUMS_a8_1","HUMS_a10_1","HUMS_a11_1","HUMS_a12_1")
survey$HUMS_adolescence_healthy <- apply(HUMS_adolescent[cols_healthy], 1,sum)
survey$HUMS_adolescence_unhealthy <- apply(HUMS_adolescent[cols_unhealthy], 1,sum)
### ADULT ###
#HUMS Scoring
HUMS_adult <- survey %>%
select("HUMS_1_1":"HUMS_13_1")
### ADULT ###
#HUMS Scoring
HUMS_adult <- survey %>%
select("HUMS1_1":"HUMS13_1")
View(HUMS_adult)
HUMS_adult <- survey %>%
select("HUMS1_1":"HUMS13_1")
cols_healthy <- c("HUMS3_1","HUMS5_1","HUMS6_1","HUMS9_1","HUMS13_1")
cols_unhealthy <- c("HUMS1_1","HUMS2_1","HUMS4_1","HUMS7_1","HUMS8_1","HUMS10_1","HUMS11_1","HUMS12_1")
survey$HUMS_adult_healthy <- apply(HUMS_adult[cols_healthy], 1,sum)
survey$HUMS_adukt_unhealthy <- apply(HUMS_adult[cols_unhealthy], 1,sum)
#isolate survey you're scoring
STAI <- survey %>%
select("STAI1_1":"STAI20_1")
#if it is a simple subscore (i.e. no reverse coding or anything)
survey$STAI_total <- apply(STAI,1, sum)
write.csv(file='../data/pleasing-displeasing_followup/scored_data.csv', survey)
library(tidyverse)
library(lme4)
library(lmerTest)
library(mediation)
scored_data <- read.csv(file="../data/pleasing-displeasing_followup/scored_data.csv")
master <- read.csv(file="../data/pleasing-displeasing_followup/pleasing_displeasing_scored.csv")
master <- master[-1]
names(master)[1] <- "ID"
names(master)[10:21] <- c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J','K','L')
names(master)[22:31] <-c('IADS105','IADS110','IADS220','IADS283','IADS351','IADS353',
'IADS423','IADS502','IADS717','IADS730')
names(master)[32:39] <- c('Envi1','Envi2','Envi3','Envi4','Envi5','Envi6','Envi7','Envi8')
just_ratings<-master[10:39] -4
cleaned <- cbind(master[1], just_ratings)
derived <- cleaned[1:13]
derivedstims <- pivot_longer(derived, A:L, names_to = "stim_name", values_to = "rating" )
IADS <- cleaned[14:23]
IADS <- cbind(cleaned[1], IADS)
IADS_stims <- pivot_longer(IADS, IADS105:IADS730, names_to = "stim_name", values_to = "rating" )
envi <- just_ratings[23:30]
envi <- cbind(cleaned[1], envi)
envi_stims <- pivot_longer(envi, Envi1:Envi8, names_to = "stim_name", values_to = "rating" )
#changing stim names for pleasing/displeasing comparisons
names(derived)[2:13] <- c("Displeasing1", "Displeasing2", "Pleasing3","Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Pleasing10", "Pleasing11", "Displeasing12")
derived_plsdispls <- pivot_longer(derived, !ID, names_to = "soundID", values_to = "rating" )
derived_plsdispls$stim_name <- gsub("[0-9]", "", derived_plsdispls$soundID)
names(IADS)[2:11] <- c("Displeasing1", "Pleasing2", "Pleasing3", "Displeasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8",
"Pleasing9", "Displeasing10")
IADS_plsdispls <- pivot_longer(IADS, !ID, names_to = "soundID", values_to = "rating")
IADS_plsdispls$stim_name <- gsub("[0-9]", "", IADS_plsdispls$soundID)
names(envi)[2:9] <- c("Displeasing1", "Displeasing2", "Pleasing3", "Pleasing4",
"Pleasing5", "Pleasing6", "Displeasing7","Displeasing8")
envi_plsdispls <- pivot_longer(envi, !ID, names_to = "soundID", values_to = "rating")
envi_plsdispls$stim_name <- gsub("[0-9]", "", envi_plsdispls$soundID)
names(scored_data)[5] <- "ID"
all_scored <- merge(master, scored_data, by.x="ID", by.y="ID")
digital <-merge(derived_plsdispls, scored_data, by.x="ID", by.y="ID")
digital_pleasing <- subset(digital, stim_name=="Pleasing")
digital_displeasing <- subset(digital, stim_name="Displeasing")
IADS<-merge(IADS_plsdispls, scored_data, by.x="ID", by.y="ID")
IADS_pleasing <- subset(IADS, stim_name=="Pleasing")
IADS_displeasing <- subset(IADS, stim_name="Displeasing")
cor.test(all_scored$HUMS_adolescence_healthy, all_scored$HUMS_adult_healthy)
cor.test(all_scored$HUMS_adolescence_unhealthy, all_scored$HUMS_adult_unhealthy)
cor.test(all_scored$HUMS_adolescence_unhealthy, all_scored$HUMS_adukt_unhealthy)
ggplot(data=all_scored, aes(x=HUMS_adolescence_unhealthy, y=HUMS_adult_healthy))+
geom_point()
ggplot(data=all_scored, aes(x=HUMS_adolescence_healthy, y=HUMS_adult_healthy))+
geom_point()
ggplot(data=all_scored, aes(x=HUMS_adolescence_healthy, y=QUIC_sum))+
geom_point()
ggplot(data=all_scored, aes(x=HUMS_adolescence_unhealthy, y=QUIC_sum))+
geom_point()
cor.test(all_scored$HUMS_adolescence_unhealthy, all_scored$QUIC_sum)
cor.test(all_scored$HUMS_adolescence_unhealthy, all_scored$QUIC_Adolescence_total)
cor.test(all_scored$HUMS_adukt_unhealthy, all_scored$QUIC_Adolescence_total)
ggplot(data=all_scored, aes(x=HUMS_adukt_unhealthy, y=QUIC_sum))+
geom_point()
cor.test(all_scored$HUMS_adult_healthy, all_scored$QUIC_Adolescence_total)
cor.test(all_scored$HUMS_adult_healthy, all_scored$QUIC_sum)
m1 <- lm(HUMS_adukt_unhealthy ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adukt_unhealthy ~ QUIC_sum, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adolescence_unhealthy ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adolescence_unhealthy ~ QUIC_adolescence_total + CHAOS_adolescence_total+ deprivation_adolescence_total + threat_adolescence_total, data=all_scored)
m1 <- lm(HUMS_adolescence_unhealthy ~ QUIC_Adolescence_total + CHAOS_adolescence_total+ deprivation_adolescence_total + threat_adolescence_total, data=all_scored)
m1 <- lm(HUMS_adolescence_unhealthy ~ QUIC_Adolescence_total + CHAOS_Adolescence_total+ deprivation_adolescence_total + threat_adolescence_total, data=all_scored)
m1 <- lm(HUMS_adolescence_unhealthy ~ QUIC_Adolescence_total + CHAOS_Adolescence_total+ deprivation_Adolescence_total + threat_adolescence_total, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adolescence_healthy ~ QUIC_Adolescence_total + CHAOS_Adolescence_total+ deprivation_Adolescence_total + threat_adolescence_total, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adult_unhealthy ~ QUIC_Adolescence_total + CHAOS_Adolescence_total+ deprivation_Adolescence_total + threat_adolescence_total, data=all_scored)
m1 <- lm(HUMS_adukt_unhealthy ~ QUIC_Adolescence_total + CHAOS_Adolescence_total+ deprivation_Adolescence_total + threat_adolescence_total, data=all_scored)
summary(m1)
m1 <- lm(HUMS_adukt_unhealthy ~ QUIC_sum + CHAOS_sum+ deprivation_sum + threat_sum, data=all_scored)
m1 <- lm(HUMS_adukt_unhealthy ~ QUIC_sum + CHAOS_sum+ deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
cor.test(all_scored$BMRQ_emotion, all_scored$QUIC_sum)
m1 <- lm(BMRQ_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
summary(m1)
#timing
m2t <- lm(BMRQ_total ~ threat_childhood_total + threat_adolescence_total, data=all_scored)
summary(m2t)
m1 <- lm(BMRQ_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PASS_Total, data=all_scored)
m1 <- lm(BMRQ_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PASS_total, data=all_scored)
summary(m1)
m1 <- lm(BMRQ_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum, data=all_scored)
m1m <- lm(BMRQ_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + PASS_total, data=all_scored)
mediate(m,m1m)
mediate(m1,m1m)
mediate(m1,m1m, mediator = "PASS_total")
mediate(m1,m1m, treat="QUIC_sum",mediator = "PASS_total")
mediation <- mediate(m1,m1m, treat="QUIC_sum",mediator = "PASS_total")
summary(mediation)
summary(m1)
summary(m1m)
