library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(mediation)
followup <- read.csv(file='../../data/SLfollowupscored.csv')
liking <- read.csv(file='../../data/SL_followup/masterinteractionliking.csv')
groove_stiminfo <- read.csv(file="../../stimuli/senn_stim/stim_information.csv")
names(groove_stiminfo)[2] <- "stim"
cor.test(followup$positive_escapism_current, followup$AIMS_current_total)
cor.test(followup$positive_escapism_current, followup$QUIC_sum)
cor.test(followup$negative_escapism_current, followup$QUIC_sum)
cor.test(followup$negative_escapism_current, followup$CHAOS_sum)
cor.test(followup$negative_escapism_current, followup$Threat_sum)
cor.test(followup$negative_escapism_current, followup$Deprivation_sum)
cor.test(followup$negative_escapism_current, followup$deprivation_sum)
cor.test(followup$positive_escapism_current, followup$deprivation_sum)
cor.test(followup$positive_escapism_current, followup$Threat_sum)
cor.test(followup$positive_escapism_current, followup$QUIC_sum)
cor.test(followup$positive_escapism_current, followup$CHAOS_sum)
m1 <-lm(data=followup, AIMS_current_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum)
summary(m1)
cor.test(followup$AIMS_current_total, followup$CHAOS_sum)
cor.test(followup$AIMS_current_total, followup$QUIC_sum)
cor.test(followup$AIMS_current_total, followup$QUIC_sum)
cor.test(followup$AIMS_current_total, followup$Threat_sum)
cor.test(followup$AIMS_current_total, followup$deprivation_sum)
cor.test(followup$MET_melodicscore, followup$CHAOS_child_total)
cor.test(followup$MET_melodicscore, followup$CHAOS_child_shortform)
library(tidyverse)
library(lme4)
library(lmerTest)
followup <- read.csv(file='../../data/SLfollowupscored.csv')
dg_conditions <- read.csv(file='../../data/SL_followup/dg_conditions.csv')
dgratings<- followup %>%
dplyr::select("A_dgroughness_1":"L_dgpleasantness_1")
roughness_index <- seq(1,24,by=2)
pleasure_index <- seq(2,24, by=2)
roughness <- dgratings[roughness_index] %>%
cbind(followup[2]) %>%
pivot_longer(!id, names_to = "stim", values_to = "rating")
x=1:nrow(roughness)
for (i in x) {
roughness$stim[i] <- gsub("_dgroughness_1", "",roughness$stim[i])
}
roughness_master <- merge(dg_conditions, roughness)
roughnessdispleasing_master <- subset(roughness_master, condition=="displeasing")
roughnessdispleasing_master <- merge(roughnessdispleasing_master, followup)
pleasantness <- dgratings[pleasure_index] %>%
cbind(followup[2]) %>%
pivot_longer(!id, names_to = "stim", values_to = "rating")
x=1:nrow(pleasantness)
for (i in x) {
pleasantness$stim[i] <- gsub("_dgpleasantness_1", "",pleasantness$stim[i])
}
pleasantness_master <- merge(dg_conditions, pleasantness)
pleasantnessdispleasing_master <- subset(pleasantness_master, condition=="displeasing")
pleasantnessdispleasing_master <- merge(pleasantnessdispleasing_master, followup)
m1 <- lmer(data=pleasantnessdispleasing_master, rating ~ QUIC_child_total + CHAOS_child_shortform + deprivation_child_total + Threat_childhood_total + (1|id))
m1 <- lmer(data=pleasantnessdispleasing_master, rating ~ QUIC_child_total + CHAOS_child_shortform + deprivation_child_total + threat_childhood_total + (1|id))
summary(m1)
m1 <- lmer(data=pleasantnessdispleasing_master, rating ~ QUIC_child_total + CHAOS_child_shortform + deprivation_child_total + threat_childhood_total + PASS_total + (1|id))
m1 <- lmer(data=pleasantnessdispleasing_master, rating ~ QUIC_child_total + CHAOS_child_shortform + deprivation_child_total + threat_childhood_total + PAS_total + (1|id))
m1 <- lmer(data=pleasantnessdispleasing_master, rating ~ QUIC_child_total + CHAOS_child_shortform + deprivation_child_total + threat_childhood_total + STAI_total + (1|id))
summary(m1)
m1 <-lm(data=followup, AIMS_current_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum)
summary(m1)
m2 <-lm(data=followup, AIMS_current_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + positive_escapism_current)
summary(m2)
m3 <-lm(data=followup, AIMS_current_total ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum + negative_escapism_current)
summary(m3)
m2 <-lm(data=followup, negative_escapism_current ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum )
summary(m2)
m2 <-lm(data=followup, positive_escapism_current ~ QUIC_sum + CHAOS_sum + deprivation_sum + Threat_sum )
summary(m2)
cor.test(followup$AIMS_current_total, followup$QUIC_child_total)
cor.test(followup$AIMS_current_total, followup$deprivation_child_total)
cor.test(followup$AIMS_current_total, followup$threat_childhood_total)
cor.test(followup$AIMS_current_total, followup$CD.RISC_total)
names(liking)[2] <- "id"
SL_master <- merge(liking, followup, by="id")
x=1:nrow(SL_master)
for (i in x) {
if (SL_master$rep[i]<3) {
SL_master$rep_category[i]="low"
} else if (SL_master$rep[i]<9) {
SL_master$rep_category[i]="medium"
} else if (SL_master$rep[i]>8) {
SL_master$rep_category[i]="high"
}
}
SL_master$rep_category <- as.factor(SL_master$rep_category)
SL_master <- within(SL_master, rep_category <- relevel(rep_category, ref = "medium"))
m1 <- lmer(data=SL_master, liking ~ rep_category*outcome_type*QUIC_sum + deprivation_sum + Threat_sum +CHAOS_sum +
(1|id) + (1|clipnum))
anova(m1)
summary(m1)
m1 <- lmer(data=SL_master, liking ~ QUIC_sum + deprivation_sum + Threat_sum + rep_category*CHAOS_sum*outcome_type +
(1|id) + (1|clipnum))
m1 <- lmer(data=SL_master, liking ~ QUIC_sum + deprivation_sum + Threat_sum + rep_category*CHAOS_sum*outcome_type +
(1|id) + (1|clipnum))
anova(m1)
summary(m1)
m1 <- lmer(data=SL_master, liking ~ QUIC_sum + deprivation_sum + rep_category*Threat_sum*outcome_type + CHAOS_sum +
(1|id) + (1|clipnum))
anova(m1)
summary(m1)
groove_stiminfo$stim <- as.character(groove_stiminfo$stim)
groove<- followup %>%
dplyr::select("X1_move_1":"X39_pleasure_1")
move_index <- seq(1,30,by=2)
pleasure_index <- seq(2,30, by=2)
move <- groove[move_index] %>%
cbind(followup[2]) %>%
pivot_longer(!id, names_to = "stim", values_to = "rating")
x=1:nrow(move)
for (i in x) {
move$stim[i] <- gsub("_move_1", "",move$stim[i])
move$stim[i] <- gsub("X", "",move$stim[i])
}
move <- merge(move, groove_stiminfo)
move$tert <- as.factor(move$tert)
##double check that for the contrasts, the weights are -1,2,-1 to low,intermediate, and high respectively
move <- within(move, tert <- relevel(tert, ref = "Low"))
m1 <- lmer(data=move, rating ~ tert + (tert|id) + (1|stim))
summary(m1)
m.emm <- emmeans(m1, "tert",lmer.df = "satterthwaite",lmerTest.limit = 3435)
m.emm <- emmeans(m1, "tert",lmer.df = "satterthwaite",lmerTest.limit = 4020)
contrast(m.emm, 'poly') %>%
broom::tidy() %>%
head(3)
##double check that for the contrasts, the weights are -1,2,-1 to low,intermediate, and high respectively
move <- within(move, tert <- relevel(tert, ref = "Intermediate"))
m1 <- lmer(data=move, rating ~ tert + (tert|id) + (1|stim))
summary(m1)
m.emm <- emmeans(m1, "tert",lmer.df = "satterthwaite",lmerTest.limit = 4020)
contrast(m.emm, 'poly') %>%
broom::tidy() %>%
head(3)
##double check that for the contrasts, the weights are -1,2,-1 to low,intermediate, and high respectively
move <- within(move, tert <- relevel(tert, ref = "Low"))
m1 <- lmer(data=move, rating ~ tert + (tert|id) + (1|stim))
m1 <- lmer(data=move, rating ~ tert + (1|id) + (1|stim))
summary(m1)
m.emm <- emmeans(m1, "tert",lmer.df = "satterthwaite",lmerTest.limit = 4020)
contrast(m.emm, 'poly') %>%
broom::tidy() %>%
head(3)
#check w/ perceived complexity ratings
m1 <- lmer(data=pleasure, rating ~ PerceivedComplexity + (PerceivedComplexity|id) + (1|stim))
#check w/ perceived complexity ratings
m1 <- lmer(data=move, rating ~ PerceivedComplexity + (PerceivedComplexity|id) + (1|stim))
summary(m1)
m2 <- lmer(data=move, rating ~ poly(PerceivedComplexity,2,raw=TRUE) + (poly(PerceivedComplexity,2,raw=TRUE)|id) + (1|stim))
m2 <- lmer(data=move, rating ~ poly(PerceivedComplexity,2,raw=TRUE) + (poly(PerceivedComplexity,2,raw=TRUE)|id) + (1|stim))
summary(m2)
anova(m1,m2)
pleasure <- groove[pleasure_index] %>%
cbind(followup[2]) %>%
pivot_longer(!id, names_to = "stim", values_to = "rating")
x=1:nrow(pleasure)
for (i in x) {
pleasure$stim[i] <- gsub("_pleasure_1", "",pleasure$stim[i])
pleasure$stim[i] <- gsub("X", "",pleasure$stim[i])
}
pleasure <- merge(pleasure, groove_stiminfo)
pleasure$tert <- as.factor(pleasure$tert)
pleasure <- within(pleasure, tert <- relevel(tert, ref = "Low"))
m1 <- lmer(data=pleasure, rating ~ tert + (tert|id) + (1|stim))
summary(m1)
m.emm <- emmeans(m1, "tert",lmer.df = "satterthwaite",lmerTest.limit = 3435)
m.emm <- emmeans(m1, "tert",lmer.df = "satterthwaite",lmerTest.limit = 4020)
contrast(m.emm, 'poly') %>%
broom::tidy() %>%
head(3)
#check w/ perceived complexity ratings
m1 <- lmer(data=pleasure, rating ~ PerceivedComplexity + (PerceivedComplexity|id) + (1|stim))
summary(m1)
m2 <- lmer(data=pleasure, rating ~ poly(PerceivedComplexity,2,raw=TRUE) + (poly(PerceivedComplexity,2,raw=TRUE)|id) + (1|stim))
summary(m2)
anova(m1,m2)
move_master <- merge(move, followup, by="id")
m1 <- lmer(data=move_master, rating ~ QUIC_sum*tert + Threat_sum + deprivation_sum + CHAOS_sum + (tert|id) + (1|stim))
summary(m1)
performance::check_collinearity(m1)
m1 <- lmer(data=move_master, rating ~ QUIC_sum + Threat_sum + deprivation_sum + CHAOS_sum*tert+ (tert|id) + (1|stim))
summary(m1)
performance::check_collinearity(m1)
pleasure_master <- merge(pleasure, followup, by="id")
m1 <- lmer(data=pleasure_master, rating ~ QUIC_sum*tert + Threat_sum + deprivation_sum + CHAOS_sum + (tert|id) + (1|stim))
m1 <- lmer(data=pleasure_master, rating ~ QUIC_sum*tert + Threat_sum + deprivation_sum + CHAOS_sum + (tert|id) + (1|stim))
summary(m1)
performance::check_collinearity(m1)
m1 <- lmer(data=pleasure_master, rating ~ QUIC_sum + Threat_sum + deprivation_sum + CHAOS_sum*tert+ (tert|id) + (1|stim))
summary(m1)
performance::check_collinearity(m1)
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(mediation)
library(corrplot)
library(psych)
library(sjPlot)
followup_scored <- read.csv(file='../../data/SLfollowupscored.csv')
liking <- read.csv(file='../../data/SL_followup/masterinteractionliking.csv')
groove_stiminfo <- read.csv(file="../../stimuli/senn_stim/stim_information.csv")
names(groove_stiminfo)[2] <- "stim"
cor.test(followup_scored$QUIC_sum, followup_scored$AIMS_current_total)
library(boot)
library(mediate)
library(mediation)
m1 <-lm(data=followup_scored, scale(STAI_total) ~ scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum))
m2 <-lm(data=followup_scored, scale(STAI_total) ~  scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum) + scale(AIMS_current_total))
mediation::mediate(m1,m2,boot=TRUE,treat = STAI_total, mediator = AIMS_current_total)
mediation::mediate(m1,m2,boot=TRUE,treat = scale(STAI_total), mediator = AIMS_current_total)
mediation::mediate(m1,m2,boot=TRUE,treat = "STAI_total", mediator = "AIMS_current_total")
mediation::mediate(m1,m2,boot=TRUE, treat = "STAI_total", mediator = "AIMS_current_total")
m1 <-lm(data=followup_scored, scale(STAI_total) ~ scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum))
m2 <-lm(data=followup_scored, scale(STAI_total) ~  scale(CHAOS_sum) + scale(deprivation_sum) + scale(Threat_sum) + scale(AIMS_current_total))
mediation::mediate(m1,m2,boot=TRUE, treat = "STAI_total", mediator = "AIMS_current_total")
mediation::mediate(m1,m2,boot=TRUE, treat = "scale(STAI_total)", mediator = "scale(AIMS_current_total)")
summary(m1)
summary(m2)
m1 <-lm(data=followup_scored, scale(STAI_total) ~ scale(CHAOS_sum))
m2 <-lm(data=followup_scored, scale(STAI_total) ~  scale(CHAOS_sum) + scale(AIMS_current_total))
mediation::mediate(m1,m2,boot=TRUE, treat = "STAI_total", mediator = "AIMS_current_total")
mediation::mediate(m1,m2,boot=TRUE, treat = "CHAOS_sum", mediator = "AIMS_current_total")
m1 <-lm(data=followup_scored, STAI_total ~ CHAOS_sum)
m2 <-lm(data=followup_scored, STAI_total ~  CHAOS_sum + AIMS_current_total)
mediation::mediate(m1,m2, boot=TRUE, treat = "CHAOS_sum", mediator = "AIMS_current_total")
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "CHAOS_sum", mediator = "AIMS_current_total")
summary(mediate)
m1 <-lm(data=followup_scored, STAI_total ~ Threat_sum)
m2 <-lm(data=followup_scored, STAI_total ~  Threat_sum + AIMS_current_total)
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "Threat_sum", mediator = "AIMS_current_total")
summary(mediate)
m1 <-lm(data=followup_scored, STAI_total ~ deprivation_sum)
m2 <-lm(data=followup_scored, STAI_total ~  deprivation_sum + AIMS_current_total)
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "deprivation_sum", mediator = "AIMS_current_total")
summary(mediate)
m1 <-lm(data=followup_scored, CD.RISC_total ~ deprivation_sum)
m2 <-lm(data=followup_scored, CD.RISC_total ~  deprivation_sum + AIMS_current_total)
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "deprivation_sum", mediator = "CD.RISC_total")
summary(mediate)
summary(m2)
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "deprivation_sum", mediator = "AIMS_current_total")
summary(mediate)
m1 <-lm(data=followup_scored, CD.RISC_total ~ Threat_sum)
m2 <-lm(data=followup_scored, CD.RISC_total ~  Threat_sum + AIMS_current_total)
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "Threat_sum", mediator = "AIMS_current_total")
summary(mediate)
summary(m1)
cor.test(followup_scored$Threat_sum, followup_scored$AIMS_current_total)
m1 <-lm(data=followup_scored, CD.RISC_total ~ CHAOS_sum)
m2 <-lm(data=followup_scored, CD.RISC_total ~  CHAOS_sum + AIMS_current_total)
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "Threat_sum", mediator = "AIMS_current_total")
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "Threat_sum", mediator = "CHAOS_sum")
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "CHAOS_sum", mediator = "AIMS_current_total")
summary(mediate)
m1 <-lm(data=followup_scored, CD.RISC_total ~ AIMS_current_total)
summary(m1)
m1 <-lm(data=followup_scored, CD.RISC_total ~ AIMS_current_total + CHAOS_sum)
summary(m1)
cor.test(followup_scored$deprivation_total, followup_scored$AIMS_current_total)
cor.test(followup_scored$deprivation_sum, followup_scored$AIMS_current_total)
mediate <- mediation::mediate(m1,m2, boot=TRUE, treat = "CHAOS_sum", mediator = "AIMS_current_total")
summary(mediate)
m1 <-lm(data=followup_scored, CD.RISC_total ~ deprivation_total)
m1 <-lm(data=followup_scored, CD.RISC_total ~ deprivation_sum)
summary(m1)
m1 <-lm(data=followup_scored, CD.RISC_total ~ AIMS_current_total)
summary(m1)
m1 <-lm(data=followup_scored, deprivation_sum ~ AIMS_current_total)
summary(m1)
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(mediation)
library(corrplot)
library(psych)
library(sjPlot)
library(mediation)
first <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
followup_scored <- read.csv(file='../../data/SLfollowupscored.csv')
keep <- setdiff(followup_scored$ID,first$Q158)
followup_scored <- followup_scored[followup_scored$ID %in% keep, ]
liking <- read.csv(file='../../data/SL_followup/masterinteractionliking.csv')
groove_stiminfo <- read.csv(file="../../stimuli/senn_stim/stim_information.csv")
names(groove_stiminfo)[2] <- "stim"
first <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
followup_scored <- read.csv(file='../../data/SLfollowupscored.csv')
#keep <- setdiff(followup_scored$ID,first$Q158)
#followup_scored <- followup_scored[followup_scored$ID %in% keep, ]
liking <- read.csv(file='../../data/SL_followup/masterinteractionliking.csv')
groove_stiminfo <- read.csv(file="../../stimuli/senn_stim/stim_information.csv")
names(groove_stiminfo)[2] <- "stim"
cor.test(followup_scored$CD.RISC_total, followup_scored$AIMS_current_total)
cor.test(followup_scored$STAI_total, followup_scored$AIMS_current_total)
cor.test(followup_scored$PASS_total, followup_scored$AIMS_current_total)
