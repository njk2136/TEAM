---
title: "4_CFA"
author: "Nick Kathios"
date: '2023-03-22'
output: html_document
---

```{r}
library(tidyverse)
source("../reverseCode.R")
library(psych)
library(corrplot)
library(lavaan)
```

#read in data
```{r}
first <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv') 
all <- read.csv(file='../../data/SLfollowupscored.csv')

keep <- setdiff(all$ID,first$Q158)

second <- all[all$ID %in% keep, ] 

MH_second <- second %>%
  dplyr::select("M.H_child1_1":"M.H_child20_1")

MH_second <- MH_second[complete.cases(MH_second),]

cols_reverse <- c("M.H_child6_1","M.H_child7_1","M.H_child11_1","M.H_child12_1","M.H_child18_1","M.H_child19_1","M.H_child20_1")
MH_second[cols_reverse] <- lapply(MH_second[cols_reverse], reverseCode, min=1, max=7)

MH_all <- all %>%
  dplyr::select("M.H_child1_1":"M.H_child20_1")

MH_all <- MH_all[complete.cases(MH_all),]

cols_reverse <- c("M.H_child6_1","M.H_child7_1","M.H_child11_1","M.H_child12_1","M.H_child18_1","M.H_child19_1","M.H_child20_1")
MH_all[cols_reverse] <- lapply(MH_all[cols_reverse], reverseCode, min=1, max=7)

#use "all" for *new* construct validity results (SRQ + MET)
#use "second" for replications of construct validity results from the EFA, as well as the CFA
#the retest df is created below

range(second$What.is.your.age.)
```

#CFA
```{r}
model <- 'G =~ M.H_child10_1 + M.H_child1_1 + M.H_child2_1 + M.H_child3_1 + M.H_child4_1 + M.H_child9_1  + M.H_child11_1  + M.H_child13_1 + M.H_child18_1 + M.H_child19_1 + M.H_child20_1 + M.H_child14_1 + M.H_child15_1 + M.H_child16_1 + M.H_child17_1 + M.H_child5_1 + M.H_child6_1 + M.H_child7_1 + M.H_child8_1 + M.H_child12_1
  
  caregiverbeliefs   =~ M.H_child2_1 + M.H_child1_1 +  + M.H_child3_1 + M.H_child4_1 
  caregiversinging =~ M.H_child10_1 + M.H_child9_1  + M.H_child11_1 + M.H_child13_1 
  childhoodattitude   =~ M.H_child20_1 + M.H_child19_1 + M.H_child18_1  
  socialcontexts  =~  M.H_child15_1 + M.H_child14_1 + M.H_child16_1 + M.H_child17_1
  musicmaking =~ M.H_child7_1 + M.H_child5_1 + M.H_child6_1  + M.H_child8_1 + M.H_child12_1

## restrictions --> make sure factors are uncorrelated
G ~~ 0*caregiverbeliefs
G ~~ 0*caregiversinging
G ~~ 0*childhoodattitude
G ~~ 0*socialcontexts
G ~~ 0*musicmaking

caregiverbeliefs ~~ 0*caregiversinging
caregiverbeliefs ~~ 0*childhoodattitude
caregiverbeliefs ~~ 0*socialcontexts
caregiverbeliefs ~~ 0*musicmaking

caregiversinging ~~ 0*childhoodattitude
caregiversinging ~~ 0*socialcontexts
caregiversinging ~~ 0*musicmaking

childhoodattitude ~~ 0*socialcontexts
childhoodattitude ~~ 0*musicmaking

socialcontexts ~~ 0*musicmaking

#residual variances --> setting to 1
    G ~~ 1*G
    caregiverbeliefs ~~ 1*caregiverbeliefs
    caregiversinging ~~ 1*caregiversinging
    childhoodattitude ~~ 1*childhoodattitude
    socialcontexts ~~ 1*socialcontexts
    musicmaking ~~ 1*musicmaking'

fitG <- lavaan::cfa(model, data = MH,std.lv=TRUE)
lavaan::summary(fitG, fit.measures = T, standardized = T)
```

```{r}
#scoring
cols_caregiverbeliefs <- c("M.H_child1_1","M.H_child2_1","M.H_child3_1","M.H_child4_1")
cols_caregiversinging <- c("M.H_child9_1","M.H_child10_1","M.H_child11_1","M.H_child13_1")
cols_childhoodattitude <- c("M.H_child18_1","M.H_child19_1","M.H_child20_1")
cols_socialcontexts <- c("M.H_child14_1","M.H_child15_1","M.H_child16_1","M.H_child17_1")
cols_musicmaking <- c("M.H_child5_1","M.H_child6_1","M.H_child7_1","M.H_child8_1", "M.H_child12_1")


#scoring
second$MH_total <- apply(MH_second,1, sum) # total BMRQ scores
second$MH_caregiverbeliefs <- apply(MH_second[cols_caregiverbeliefs], 1,sum)
second$MH_caregiversinging <- apply(MH_second[cols_caregiversinging],1, sum)
second$MH_childhoodattitude <-apply(MH_second[cols_childhoodattitude],1, sum)
second$MH_socialcontexts <- apply(MH_second[cols_socialcontexts],1, sum)
second$MH_musicmaking <- apply(MH_second[cols_musicmaking],1, sum)

all$MH_total <- apply(MH_all,1, sum) # total BMRQ scores
all$MH_caregiverbeliefs <- apply(MH_all[cols_caregiverbeliefs], 1,sum)
all$MH_caregiversinging <- apply(MH_all[cols_caregiversinging],1, sum)
all$MH_childhoodattitude <-apply(MH_all[cols_childhoodattitude],1, sum)
all$MH_socialcontexts <- apply(MH_all[cols_socialcontexts],1, sum)
all$MH_musicmaking <- apply(MH_all[cols_musicmaking],1, sum)


#validity tests
variables = dplyr::select(second, 
                          MH_total,MH_caregiverbeliefs,
                          MH_caregiversinging, MH_childhoodattitude, MH_musicmaking, MH_socialcontexts,
                          MET_melodicscore, MET_rhythmicscore, SRQ_adol_total,
                          SRQ_current_total)
output = corr.test(variables)

corr_matrix = output$r
p_matrix <- output$p

colnames(corr_matrix) <- c("1","2", "3",
                           "4", "5", 
                           "6","7", "8", 
                           "9", "10")
rownames(corr_matrix) <- c("1","2", "3",
                           "4", "5", 
                           "6","7", "8", 
                           "9", "10")

pdf(file = "../../figures/statistical_learningfollowup/CFA_new.pdf",width = 13, height=13)

corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1), diag = FALSE,tl.cex = 3, cl.cex = 2)

dev.off()

m1 <- lm(CD.RISC_total ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_musicmaking + MH_socialcontexts, data=second)
summary(m1)
```


#test-retest correlations
```{r}
'%notin%' <- Negate('%in%')
retest <- subset(all, all$ID %notin% second$ID)
retest <- merge(retest, first, by.x = "ID", by.y = "PROLIFIC_PID")

range(retest$What.is.your.age., na.rm = TRUE)
mean(retest$What.is.your.age., na.rm = TRUE)

table(retest$What.is.your.ethnicity..check.all.that.apply..)

icc(retest$MH_total.x, retest$MH_total.y, model = "twoway", type = "consistency")

#ICMPC Poster
MH_musicmaking.x <- retest$MH_musicmaking.x
MH_musicmaking.y <- retest$MH_musicmaking.y
corr.test(MH_musicmaking.x, MH_musicmaking.y)
```


```{r}
variables = dplyr::select(second, 
                          MH_total,
                          MH_caregiverbeliefs, MH_caregiversinging,
                          MH_childhoodattitude, MH_musicmaking, 
                          MH_socialcontexts, QUIC_child_total,
                          QUIC_child_parentalmonitoring, QUIC_child_parentalenvironment,
                          QUIC_child_parentalpredictability, QUIC_child_physiscalenvironment,
                          QUIC_child_safetyandsecurity, deprivation_child_total,
                          deprivation_child_emotional, deprivation_child_physical,
                          deprivation_child_cognitive, threat_childhood_total,
                          threat_childhood_home, threat_childhood_neighborhood,
                          CHAOS_child_total, CHAOS_child_shortform,
                          STAI_total, PASS_total, CD.RISC_total, HUMS_adult_healthy, HUMS_adult_unhealthy,
                          What.is.your.age., Gold_activeengagement,Gold_perceptualabilities, Gold_musicaltraining,
                          Gold_singingabilities, Gold_emotion, Gold_musicalsophistication,BMRQ_total, BMRQ_emotion, )
output = corr.test(variables)
corr_matrix <- output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Childhood Attitude', 'Childhood Engagement with Music', 'Social Contexts', 'QUIC Total', 'QUIC Parental Monitoring', 'QUIC Parental Environment', 'QUIC Parental Predictability', 'QUIC Physical Environment', 'QUIC Safety and Security', 'Deprivation Total', 'Deprivation Emotional', 'Deprivation Physical', 'Deprivation Cognitive', 'Threat Total', 'Threat Home', 'Threat Neighborhood', 'CHAOS Total', 'CHAOS Short Form', 'STAI', 'PASS', 'CD RISC', "Healthy Music Usage", "Unhealthy Music Usage", "Age", "GoldMSI - Active Engagement", "GoldMSI - Perceptual Abilities", "GoldMSI - Musical Training", "GoldMSI - Singing Abilities", "GoldMSI - Emotion", "GoldMSI - Musical Sophistication")
rownames(corr_matrix) <- c('General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Childhood Attitude', 'Childhood Engagement with Music', 'Social Contexts', 'QUIC Total', 'QUIC Parental Monitoring', 'QUIC Parental Environment', 'QUIC Parental Predictability', 'QUIC Physical Environment', 'QUIC Safety and Security', 'Deprivation Total', 'Deprivation Emotional', 'Deprivation Physical', 'Deprivation Cognitive', 'Threat Total', 'Threat Home', 'Threat Neighborhood', 'CHAOS Total', 'CHAOS Short Form', 'STAI', 'PASS','CD RISC', "Healthy Music Usage", "Unhealthy Music Usage", "Age","GoldMSI - Active Engagement", "GoldMSI - Perceptual Abilities", "GoldMSI - Musical Training", "GoldMSI - Singing Abilities", "GoldMSI - Emotion", "GoldMSI - Musical Sophistication")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
```

#For Figures 3 + 4 of manuscript
```{r}
#Replications
variables = dplyr::select(second, 
                          MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts,
                          MH_musicmaking, Gold_activeengagement, Gold_perceptualabilities, Gold_musicaltraining,
                          Gold_singingabilities, Gold_emotion, Gold_musicalsophistication, BMRQ_total, BMRQ_moodreg, BMRQ_emotion,
                          BMRQ_socialreward, BMRQ_musicseek, BMRQ_sensorimotor,QUIC_child_total, 
                          CHAOS_child_total, deprivation_child_total, threat_childhood_total)
output = corr.test(variables)

corr_matrix = output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('1', '2', '3', '4', '5', '6', '7', "8", "9", "10", "11", "12",'13', '14', '15', '16', '17', '18',
                         '19',"20", "21", "22")
rownames(corr_matrix) <- c('1', '2', '3', '4', '5', '6', '7', "8", "9", "10", "11", "12",'13', '14', '15', '16', '17', '18',
                         '19',"20", "21", "22")


pdf(file = "../../figures/pleasing:displeasing_followup/EFA_corrplot_totalsnobold.pdf", width = 13, height=13)

## update to get corrplot2
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1), diag = FALSE,tl.cex = 1, cl.cex = 1)
dev.off()

#new construct validity
variables = dplyr::select(all, 
                          MH_total,
                          MH_caregiverbeliefs, MH_caregiversinging,
                          MH_childhoodattitude, MH_musicmaking, 
                          MH_socialcontexts, SRQ_adol_total, SRQ_current_total,
                          MET_melodicscore, MET_rhythmicscore,
                          What.is.your.age.)

output = corr.test(variables)
corr_matrix <- output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11')
rownames(corr_matrix) <- c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11')
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))


#utility of scale
variables = dplyr::select(all, 
                          MH_total,
                          MH_caregiverbeliefs, MH_caregiversinging,
                          MH_childhoodattitude, MH_musicmaking, 
                          MH_socialcontexts,
                          MET_melodicscore, MET_rhythmicscore,
                          HUMS_adult_healthy, HUMS_adult_unhealthy, 
                          STAI_total, CD.RISC_total)

output = corr.test(variables)
corr_matrix <- output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')
rownames(corr_matrix) <- c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))

cor.test()

```

#updated figures for manuscript 9/25
```{r}
#Replications GoldMSI
variables = dplyr::select(second, 
                          MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts,
                          MH_musicmaking, Gold_activeengagement, Gold_perceptualabilities, Gold_musicaltraining,
                          Gold_singingabilities, Gold_emotion, Gold_musicalsophistication)
output = corr.test(variables)

corr_matrix = output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'Active Engagment', "Perceptual Abilities", "Musical Training", "Singing Abilities", "Emotion", "Musical Sophistication")
rownames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'Active Engagment', "Perceptual Abilities", "Musical Training", "Singing Abilities", "Emotion", "Musical Sophistication")

pdf(file = "../../figures/m@h/Gold_Study2.pdf")

## update to get corrplot2
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1), diag = FALSE,tl.cex = 1, cl.cex = 1)

dev.off()

#Replications BMRQ 
variables = dplyr::select(second, 
                          MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts,
                          MH_musicmaking, BMRQ_total, BMRQ_moodreg, BMRQ_emotion,
                          BMRQ_socialreward, BMRQ_musicseek, BMRQ_sensorimotor)
output = corr.test(variables)

corr_matrix = output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'BMRQ Total', "Mood Regulation", "Emotion", "Social Reward", "Music Seeking", "Sensorimotor")
rownames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'BMRQ Total', "Mood Regulation", "Emotion", "Social Reward", "Music Seeking", "Sensorimotor")

pdf(file = "../../figures/m@h/BMRQ_Study2.pdf")

## update to get corrplot2
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1), diag = FALSE,tl.cex = 1, cl.cex = 1)

dev.off()

#Adversity 
variables = dplyr::select(second, 
                          MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts,
                          MH_musicmaking, QUIC_child_total, deprivation_child_total, threat_childhood_total, CHAOS_child_total)
output = corr.test(variables)

corr_matrix = output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'QUIC', "Deprivation", "Threat", "CHAOS")
rownames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'QUIC', "Deprivation", "Threat", "CHAOS")

pdf(file = "../../figures/m@h/Adversity_Study2.pdf")

## update to get corrplot2
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1), diag = FALSE,tl.cex = 1, cl.cex = 1)

dev.off()

#SRQ
variables = dplyr::select(all, 
                          MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts,
                          MH_musicmaking, SRQ_current_total)
output = corr.test(variables)

corr_matrix = output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'SRQ')
rownames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'SRQ')

pdf(file = "../../figures/m@h/SRQ_Study2.pdf")

## update to get corrplot2
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1), diag = FALSE,tl.cex = 1, cl.cex = 1)

dev.off()

#MET
variables = dplyr::select(all, 
                          MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts,
                          MH_musicmaking, MET_melodicscore, MET_rhythmicscore)
output = corr.test(variables)

corr_matrix = output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'MET Melodic', 'MET Rhythmic')
rownames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'MET Melodic', 'MET Rhythmic')

pdf(file = "../../figures/m@h/MET_Study2.pdf")

## update to get corrplot2
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1), diag = FALSE,tl.cex = 1, cl.cex = 1)

dev.off()

#HUMS
variables = dplyr::select(all, 
                          MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts,
                          MH_musicmaking, HUMS_adult_healthy, HUMS_adult_unhealthy)
output = corr.test(variables)

corr_matrix = output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'HUMS Healthy', 'HUMS Unhealthy')
rownames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'HUMS Healthy', 'HUMS Unhealthy')

pdf(file = "../../figures/m@h/HUMS_Study2.pdf")

## update to get corrplot2
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1), diag = FALSE,tl.cex = 1, cl.cex = 1)

dev.off()

#Mental Health
variables = dplyr::select(all, 
                          MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts,
                          MH_musicmaking, STAI_total, CD.RISC_total)
output = corr.test(variables)

corr_matrix = output$r
p_matrix <- output$p

colnames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'STAI', 'CD.RISC')
rownames(corr_matrix) <- c('M@HR General', 'M@HR Caregiver Beliefs', 'M@HR Caregiver Singing', 'M@HR Attitude', 'M@HR Social Contexts', 'M@HR Child Engagement', 'STAI', 'CD.RISC')

pdf(file = "../../figures/m@h/mentalhealth_Study2.pdf")

## update to get corrplot2
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
         sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45, 
         col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1), diag = FALSE,tl.cex = 1, cl.cex = 1)

dev.off()

#Utility of Scale Scatterplots
MET_melodic_general <-
ggplot(all, aes(x=MH_total, y=MET_melodicscore)) + 
  theme_classic() +
  geom_point() + 
  geom_smooth(method=lm) + 
  xlab("M@HR General") +
  ylab("MET Melodic") +
  theme(axis.title=element_text(size=20,face="bold"), axis.text=element_text(size=15))
print(MET_melodic_general)
ggsave("MET_melodic_general.png", width = 6.5, height = 4)

MET_melodic_cbeliefs <-
ggplot(all, aes(x=MH_caregiverbeliefs, y=MET_melodicscore)) + 
  theme_classic() +
  geom_point(position="jitter") + 
  geom_smooth(method=lm) + 
  xlab("M@HR Caregiver Beliefs") +
  ylab("MET Melodic") +
  theme(axis.title=element_text(size=20,face="bold"), axis.text=element_text(size=15))
print(MET_melodic_cbeliefs)
ggsave("MET_melodic_cbeliefs.png", width = 6.5, height = 4)

MET_melodic_childengagement <-
ggplot(all, aes(x=MH_musicmaking, y=MET_melodicscore)) + 
  theme_classic() +
  geom_point(position="jitter") + 
  geom_smooth(method=lm) + 
  xlab("M@HR Child Engagement") +
  ylab("MET Melodic") +
  theme(axis.title=element_text(size=20,face="bold"), axis.text=element_text(size=15))
print(MET_melodic_childengagement)
ggsave("MET_melodic_childengagement.png", width = 6.5, height = 4)

MH_total <- all$MH_total
MET_melodicscore <- all$MET_melodicscore
corr.test(MH_total, MET_melodicscore)

HUMS_healthy <-
ggplot(all, aes(x=MH_total, y=HUMS_adult_healthy)) + 
  theme_classic() +
  geom_point(position="jitter") + 
  geom_smooth(method=lm) + 
  xlab("M@HR General") +
  ylab("HUMS Healthy") +
  theme(axis.title=element_text(size=20,face="bold"), axis.text=element_text(size=15))
print(HUMS_healthy)
ggsave("HUMS_healthy.png", width = 6.5, height = 4)

HUMS_unhealthy <-
ggplot(all, aes(x=MH_childhoodattitude, y=HUMS_adult_unhealthy)) + 
  theme_classic() +
  geom_point(position="jitter") + 
  geom_smooth(method=lm) + 
  xlab("M@HR Attitude") +
  ylab("HUMS Unhealthy") +
  theme(axis.title=element_text(size=20,face="bold"), axis.text=element_text(size=15))
print(HUMS_unhealthy)
ggsave("HUMS_unhealthy.png", width = 6.5, height = 4)

STAI <-
ggplot(all, aes(x=MH_total, y=STAI_total)) + 
  theme_classic() +
  geom_point() + 
  geom_smooth(method=lm) + 
  xlab("M@HR General") +
  ylab("STAI") +
  theme(axis.title=element_text(size=20,face="bold"), axis.text=element_text(size=15))
print(STAI)
ggsave("STAI.png", width = 6.5, height = 4)

STAI_total <- all$STAI_total
corr.test(MH_total, STAI_total)

CD.RISC <-
ggplot(all, aes(x=MH_total, y=CD.RISC_total)) + 
  theme_classic() +
  geom_point() + 
  geom_smooth(method=lm) + 
  xlab("M@HR General") +
  ylab("CD.RISC") +
  theme(axis.title=element_text(size=20,face="bold"), axis.text=element_text(size=15))
print(CD.RISC)
ggsave("CD.RISC.png", width = 6.5, height = 4)

SRQ<-
ggplot(all, aes(x=MH_total, y=SRQ_current_total)) + 
  theme_classic() +
  geom_point() + 
  geom_smooth(method=lm) + 
  xlab("M@HR General") +
  ylab("SRQ") +
  theme(axis.title=element_text(size=20,face="bold"), axis.text=element_text(size=15))
print(SRQ)
ggsave("SRQ.png", width = 6.5, height = 4)

SRQ_current_total <- all$SRQ_current_total
corr.test(MH_total, SRQ_current_total)
```


#Utility of scale models
```{r}
cor.test(all$MH_musicmaking, all$MET_rhythmicscore)
m1 <- lm(HUMS_adult_healthy ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_musicmaking + MH_socialcontexts, data = all)
summary(m1)

m1 <- lm(PASS_total ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_musicmaking + MH_socialcontexts, data = all)
summary(m1)

m1 <- lm(STAI_total ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_musicmaking + MH_socialcontexts, data = all)
summary(m1)

##scatter plots##
ggplot(data=all, aes(x=MH_total, y=CD.RISC_total))+
  geom_point()+
  stat_smooth(method="lm") +
  theme_classic()
```

