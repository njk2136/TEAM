#scoring
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H17_1","M.H29_1","M.H30_1",
"M.H32_1")
cols_caregiverbeliefs <- c("M.H1_1","M.H2_1","M.H3_1","M.H4_1")
cols_caregiversinging <- c("M.H9_1","M.H10_1","M.H12_1","M.H16_1")
cols_childhoodattitude <- c("M.H29_1","M.H30_1","M.H32_1")
cols_socialcontexts <- c("M.H21_1","M.H25_1","M.H26_1","M.H28_1")
cols_musicmaking <- c("M.H5_1","M.H6_1","M.H7_1","M.H8_1", "M.H14_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode)
#scoring
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H29_1","M.H30_1",
"M.H32_1")
cols_caregiverbeliefs <- c("M.H1_1","M.H2_1","M.H3_1","M.H4_1")
cols_caregiversinging <- c("M.H9_1","M.H10_1","M.H12_1","M.H16_1")
cols_childhoodattitude <- c("M.H29_1","M.H30_1","M.H32_1")
#scoring
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H29_1","M.H30_1",
"M.H32_1")
cols_caregiverbeliefs <- c("M.H1_1","M.H2_1","M.H3_1","M.H4_1")
cols_caregiversinging <- c("M.H9_1","M.H10_1","M.H12_1","M.H16_1")
cols_childhoodattitude <- c("M.H29_1","M.H30_1","M.H32_1")
cols_socialcontexts <- c("M.H21_1","M.H25_1","M.H26_1","M.H28_1")
cols_musicmaking <- c("M.H5_1","M.H6_1","M.H7_1","M.H8_1", "M.H14_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode)
#scoring
scored_data$MH_total <- apply(MH,1, sum) # total BMRQ scores
scored_data$MH_caregiverbeliefs <- apply(MH[cols_caregiverbeliefs], 1,sum)
scored_data$MH_caregiversinging <- apply(MH[cols_caregiversinging],1, sum)
scored_data$MH_childhoodattitude <-apply(MH[cols_childhoodattitude],1, sum)
range(MH)
range(MH, na.rm = TRUE)
scored_data<-read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
#scores <- read.csv(file =  "../../data/m@hr/efa_factorscores.csv")
master <- read.csv(file="../../data/pleasing-displeasing_followup/pleasing_displeasing_scored.csv")
names(scores)[2] <- "ID"
names(scored_data)[20] <- "ID"
master <- master[-1]
names(master)[1] <- "ID"
#scoring
MH <- scored_data %>%
dplyr::select("M.H1_1":"M.H35_1")
MH <- MH[-c(32:34)] %>%
dplyr::select(-c("M.H17_1", "M.H20_1", "M.H18_1","M.H19_1","M.H13_1","M.H27_1","M.H23_1")) %>%
dplyr::select( -c("M.H15_1", "M.H24_1")) %>%
dplyr::select( -c("M.H22_1", "M.H31_1"))
#scoring
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H29_1","M.H30_1",
"M.H32_1")
cols_caregiverbeliefs <- c("M.H1_1","M.H2_1","M.H3_1","M.H4_1")
cols_caregiversinging <- c("M.H9_1","M.H10_1","M.H12_1","M.H16_1")
cols_childhoodattitude <- c("M.H29_1","M.H30_1","M.H32_1")
cols_socialcontexts <- c("M.H21_1","M.H25_1","M.H26_1","M.H28_1")
cols_musicmaking <- c("M.H5_1","M.H6_1","M.H7_1","M.H8_1", "M.H14_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode,  min=1, max=7)
#scoring
scored_data$MH_total <- apply(MH,1, sum) # total BMRQ scores
scored_data$MH_caregiverbeliefs <- apply(MH[cols_caregiverbeliefs], 1,sum)
scored_data$MH_caregiversinging <- apply(MH[cols_caregiversinging],1, sum)
scored_data$MH_childhoodattitude <-apply(MH[cols_childhoodattitude],1, sum)
scored_data$MH_socialcontexts <- apply(MH[cols_socialcontexts],1, sum)
scored_data$MH_musicmaking <- apply(MH[cols_musicmaking],1, sum)
full <- merge(scored_data, master,by.x="ID", by.y="ID")
#removing anyone missing ELA measures
full <- full[complete.cases(full[391:418]),]
#M@HR + GoldMSI
variables = dplyr::select(full,
MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts, MH_musicmaking,
Gold_activeengagement, Gold_perceptualabilities, Gold_musicaltraining, Gold_singingabilities,
Gold_emotion, Gold_musicalsophistication)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies',
'GoldMSI Active Engagement', "GoldMSI Perceptual Abilities", "GoldMSI Musical Training", "GoldMSI Singing Abilities", "GoldMSI Emotion", "GoldMSI Musical Sophistication")
rownames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singingg', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies',
'GoldMSI Active Engagement', "GoldMSI Perceptual Abilities", "GoldMSI Musical Training", "GoldMSI Singing Abilities", "GoldMSI Emotion", "GoldMSI Musical Sophistication")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
variables = dplyr::select(full,
MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts, MH_musicmaking,
BMRQ_total, BMRQ_moodreg, BMRQ_emotion, BMRQ_socialreward,
BMRQ_absorption, BMRQ_musicseek, BMRQ_sensorimotor)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies','Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor')
rownames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies','Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor')
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
#M@HR + ELA measures
variables = dplyr::select(full,
MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts, MH_musicmaking, QUIC_child_total,
CHAOS_child_total, deprivation_child_total, threat_childhood_total)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies', "QUIC Childhood", "CHAOS Childhood", "Deprivation Childhood", "Threat Childhood")
rownames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies', "QUIC Childhood", "CHAOS Childhood", "Deprivation Childhood", "Threat Childhood")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
#M@HR + eBMRQ
#generate correlation matrix
#gather variables of interest
variables = dplyr::select(full,
MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts, MH_musicmaking,
BMRQ_total, BMRQ_moodreg, BMRQ_emotion, BMRQ_socialreward,
BMRQ_absorption, BMRQ_musicseek, BMRQ_sensorimotor)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies','Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor')
rownames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies','Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor')
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
m1 <- lm(data=full, BMRQ_socialreward ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_socialcontexts + MH_musicmaking)
summary(m1)
m1 <- lm(data=full, BMRQ_total ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_socialcontexts + MH_musicmaking)
summary(m1)
performance::check_collinearity(m1)
summary(m1)
m1 <- lm(data=full, HUMS_adult_healthy ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_socialcontexts + MH_musicmaking)
summary(m1)
m1 <- lm(data=full, BMRQ_socialreward ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_socialcontexts + MH_musicmaking)
summary(m1)
m1 <- lm(data=full, BMRQ_total ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_socialcontexts + MH_musicmaking)
summary(m1)
m1 <- lm(data=full, HUMS_adult_healthy ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_socialcontexts + MH_musicmaking)
summary(m1)
m1 <- lm(data=full, HUMS_adult_unhealthy ~ MH_caregiverbeliefs + MH_caregiversinging + MH_childhoodattitude + MH_socialcontexts + MH_musicmaking)
summary(m1)
variables = dplyr::select(full,
MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts, MH_musicmaking,
Gold_activeengagement, Gold_perceptualabilities, Gold_musicaltraining, Gold_singingabilities,
Gold_emotion, Gold_musicalsophistication)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies',
'GoldMSI Active Engagement', "GoldMSI Perceptual Abilities", "GoldMSI Musical Training", "GoldMSI Singing Abilities", "GoldMSI Emotion", "GoldMSI Musical Sophistication")
rownames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singingg', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies',
'GoldMSI Active Engagement', "GoldMSI Perceptual Abilities", "GoldMSI Musical Training", "GoldMSI Singing Abilities", "GoldMSI Emotion", "GoldMSI Musical Sophistication")
pdf(file = "../../figures/pleasing:displeasing_followup/BMRQ_corrplot_totals.pdf")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
dev.off()
variables = dplyr::select(full,
MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts, MH_musicmaking,
BMRQ_total, BMRQ_moodreg, BMRQ_emotion, BMRQ_socialreward,
BMRQ_absorption, BMRQ_musicseek, BMRQ_sensorimotor)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies','Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor')
rownames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies','Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor')
pdf(file = "../figures/pleasing:displeasing_followup/BMRQ_corrplot_totals.pdf")
variables = dplyr::select(full,
MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts, MH_musicmaking,
BMRQ_total, BMRQ_moodreg, BMRQ_emotion, BMRQ_socialreward,
BMRQ_absorption, BMRQ_musicseek, BMRQ_sensorimotor)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies','Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor')
rownames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies','Total BMRQ', 'Mood Regulation', 'Emotion Evocation', 'Social Reward', 'Absorption', 'Music Seeking',
'Sensorimotor')
pdf(file = "../../figures/pleasing:displeasing_followup/BMRQ_corrplot_totals.pdf")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
dev.off()
variables = dplyr::select(full,
MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts, MH_musicmaking, QUIC_child_total,
CHAOS_child_total, deprivation_child_total, threat_childhood_total)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies', "QUIC Childhood", "CHAOS Childhood", "Deprivation Childhood", "Threat Childhood")
rownames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies', "QUIC Childhood", "CHAOS Childhood", "Deprivation Childhood", "Threat Childhood")
pdf(file = "../figures/pleasing:displeasing_followup/BMRQ_corrplot_totals.pdf")
variables = dplyr::select(full,
MH_total, MH_caregiverbeliefs, MH_caregiversinging, MH_childhoodattitude, MH_socialcontexts, MH_musicmaking, QUIC_child_total,
CHAOS_child_total, deprivation_child_total, threat_childhood_total)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies', "QUIC Childhood", "CHAOS Childhood", "Deprivation Childhood", "Threat Childhood")
rownames(corr_matrix) <- c('M@H-R General Score', 'Caregiver Beliefs', 'Caregiver Singing', 'Attitude to Childhood Music', 'Social Contexts', 'Music-Making Tendencies', "QUIC Childhood", "CHAOS Childhood", "Deprivation Childhood", "Threat Childhood")
pdf(file = "../../figures/pleasing:displeasing_followup/BMRQ_corrplot_totals.pdf")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
dev.off()
library(tidyverse)
source("../reverseCode.R")
library(psych)
library(corrplot)
first <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
second <- read.csv(file='../../data/SLfollowupscored.csv')
keep <- setdiff(second$ID,first$Q158)
second <- second[second$ID %in% keep, ]
MH <- second %>%
dplyr::select("M.H_child1_1":"M.H_child20_1")
#MH <- MH[complete.cases(MH),]
cols_reverse <- c("M.H_child6_1","M.H_child7_1","M.H_child11_1","M.H_child12_1","M.H_child18_1","M.H_child19_1","M.H_child20_1")
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode, min=1, max=7)
#scoring
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H29_1","M.H30_1",
"M.H32_1")
cols_caregiverbeliefs <- c("M.H1_1","M.H2_1","M.H3_1","M.H4_1")
cols_caregiversinging <- c("M.H9_1","M.H10_1","M.H12_1","M.H16_1")
cols_childhoodattitude <- c("M.H29_1","M.H30_1","M.H32_1")
cols_socialcontexts <- c("M.H21_1","M.H25_1","M.H26_1","M.H28_1")
cols_musicmaking <- c("M.H5_1","M.H6_1","M.H7_1","M.H8_1", "M.H14_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode,  min=1, max=7)
View(MH)
cols_reverse <- c("M.H6_1","M.H7_1","M.H11_1","M.H12_1","M.H18_1","M.H19_1",
"M.H20_1")
cols_caregiverbeliefs <- c("M.H1_1","M.H2_1","M.H3_1","M.H4_1")
cols_caregiversinging <- c("M.H9_1","M.H10_1","M.H11_1","M.H13_1")
cols_childhoodattitude <- c("M.H18_1","M.H19_1","M.H20_1")
cols_socialcontexts <- c("M.H14_1","M.H15_1","M.H16_1","M.H17_1")
cols_musicmaking <- c("M.H5_1","M.H6_1","M.H7_1","M.H8_1", "M.H12_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode,  min=1, max=7)
cols_reverse <- c("M.H_child6_1","M.H_child7_1","M.H_child11_1","M.H_child12_1","M.H_child18_1","M.H_child19_1",
"M.H_child20_1")
cols_caregiverbeliefs <- c("M.H_child1_1","M.H_child2_1","M.H_child3_1","M.H_child4_1")
cols_caregiversinging <- c("M.H_child9_1","M.H_child10_1","M.H_child11_1","M.H_child13_1")
cols_childhoodattitude <- c("M.H_child18_1","M.H_child19_1","M.H_child20_1")
cols_socialcontexts <- c("M.H_child14_1","M.H_child15_1","M.H_child16_1","M.H_child17_1")
cols_musicmaking <- c("M.H_child5_1","M.H_child6_1","M.H_child7_1","M.H_child8_1", "M.H_child12_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode,  min=1, max=7)
#scoring
MH$MH_total <- apply(MH,1, sum) # total BMRQ scores
MH$MH_caregiverbeliefs <- apply(MH[cols_caregiverbeliefs], 1,sum)
MH$MH_caregiversinging <- apply(MH[cols_caregiversinging],1, sum)
MH$MH_childhoodattitude <-apply(MH[cols_childhoodattitude],1, sum)
MH$MH_socialcontexts <- apply(MH[cols_socialcontexts],1, sum)
MH$MH_musicmaking <- apply(MH[cols_musicmaking],1, sum)
#validity tests
total <- merge(MH, second)
View(total)
View(MH)
second$MH_total <- apply(MH,1, sum) # total BMRQ scores
second$MH_caregiverbeliefs <- apply(MH[cols_caregiverbeliefs], 1,sum)
second$MH_caregiversinging <- apply(MH[cols_caregiversinging],1, sum)
second$MH_childhoodattitude <-apply(MH[cols_childhoodattitude],1, sum)
second$MH_socialcontexts <- apply(MH[cols_socialcontexts],1, sum)
second$MH_musicmaking <- apply(MH[cols_musicmaking],1, sum)
#validity tests
variables = dplyr::select(second,
General,CaregiverSinging,
CaregiverBeliefs, HomeAttitudes, MusicMaking, Social,
MET_melodicscore, MET_rhythmicscore, SRQ_adol_total,
SRQ_current_total)
#validity tests
variables = dplyr::select(second,
MH_total,MH_caregiverbeliefs,
MH_caregiversinging, MH_childhoodattitude, MH_musicmaking, MH_socialcontexts,
MET_melodicscore, MET_rhythmicscore, SRQ_adol_total,
SRQ_current_total)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c("MH General Score", "Caregiver Singing","Caregiver Beliefs",
"Attitude towards Home Musical Environment", "Music Making Tendencies",
"Social Contexts","MET Melodic Score", "MET Rhythmic Score",
"Adolescent SRQ", "Current SRQ")
colnames(corr_matrix) <- c("MH General Score","Caregiver Beliefs", "Caregiver Singing",
"Attitude towards Home Musical Environment", "Music Making Tendencies",
"Social Contexts","MET Melodic Score", "MET Rhythmic Score",
"Adolescent SRQ", "Current SRQ")
rownames(corr_matrix) <- c("MH General Score","Caregiver Beliefs", "Caregiver Singing",
"Attitude towards Home Musical Environment", "Music Making Tendencies",
"Social Contexts","MET Melodic Score", "MET Rhythmic Score",
"Adolescent SRQ", "Current SRQ")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
cols_reverse <- c("M.H_child6_1","M.H_child7_1","M.H_child11_1","M.H_child12_1","M.H_child18_1","M.H_child19_1",
"M.H_child20_1")
cols_caregiverbeliefs <- c("M.H_child1_1","M.H_child2_1","M.H_child3_1","M.H_child4_1")
cols_caregiversinging <- c("M.H_child9_1","M.H_child10_1","M.H_child11_1","M.H_child13_1")
cols_childhoodattitude <- c("M.H_child18_1","M.H_child19_1","M.H_child20_1")
cols_socialcontexts <- c("M.H_child14_1","M.H_child15_1","M.H_child16_1","M.H_child17_1")
cols_musicmaking <- c("M.H_child5_1","M.H_child6_1","M.H_child7_1","M.H_child8_1", "M.H_child12_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode,  min=1, max=7)
#scoring
second$MH_total <- apply(MH,1, sum) # total BMRQ scores
second$MH_caregiverbeliefs <- apply(MH[cols_caregiverbeliefs], 1,sum)
second$MH_caregiversinging <- apply(MH[cols_caregiversinging],1, sum)
second$MH_childhoodattitude <-apply(MH[cols_childhoodattitude],1, sum)
second$MH_socialcontexts <- apply(MH[cols_socialcontexts],1, sum)
second$MH_musicmaking <- apply(MH[cols_musicmaking],1, sum)
#validity tests
variables = dplyr::select(second,
MH_total,MH_caregiverbeliefs,
MH_caregiversinging, MH_childhoodattitude, MH_musicmaking, MH_socialcontexts,
MET_melodicscore, MET_rhythmicscore, SRQ_adol_total,
SRQ_current_total)
output = corr.test(variables)
corr_matrix = output$r
p_matrix <- output$p
colnames(corr_matrix) <- c("MH General Score","Caregiver Beliefs", "Caregiver Singing",
"Attitude towards Home Musical Environment", "Music Making Tendencies",
"Social Contexts","MET Melodic Score", "MET Rhythmic Score",
"Adolescent SRQ", "Current SRQ")
rownames(corr_matrix) <- c("MH General Score","Caregiver Beliefs", "Caregiver Singing",
"Attitude towards Home Musical Environment", "Music Making Tendencies",
"Social Contexts","MET Melodic Score", "MET Rhythmic Score",
"Adolescent SRQ", "Current SRQ")
corrplot(corr_matrix, p.mat = p_matrix, insig = "label_sig",
sig.level = c(0.001,0.01,0.05), pch.cex=0.9, pch.col = "black", tl.col = "black", type="lower",tl.srt =45,
col=colorRampPalette(c("darkblue","white","red"))(100),cl.lim=c(0,1))
library(tidyverse)
library(corrplot)
library(corrplot)
source("../reverseCode.R")
library(tidyverse)
library(corrplot)
library(corrplot)
source("../reverseCode.R")
scored_data<-read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
master <- read.csv(file="../../data/pleasing-displeasing_followup/pleasing_displeasing_scored.csv")
names(scores)[2] <- "ID"
scored_data<-read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
master <- read.csv(file="../../data/pleasing-displeasing_followup/pleasing_displeasing_scored.csv")
names(scored_data)[20] <- "ID"
master <- master[-1]
names(master)[1] <- "ID"
#scoring
MH <- scored_data %>%
dplyr::select("M.H1_1":"M.H35_1")
MH <- MH[-c(32:34)] %>%
dplyr::select(-c("M.H17_1", "M.H20_1", "M.H18_1","M.H19_1","M.H13_1","M.H27_1","M.H23_1")) %>%
dplyr::select( -c("M.H15_1", "M.H24_1")) %>%
dplyr::select( -c("M.H22_1", "M.H31_1"))
#scoring
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H29_1","M.H30_1",
"M.H32_1")
cols_caregiverbeliefs <- c("M.H1_1","M.H2_1","M.H3_1","M.H4_1")
cols_caregiversinging <- c("M.H9_1","M.H10_1","M.H12_1","M.H16_1")
cols_childhoodattitude <- c("M.H29_1","M.H30_1","M.H32_1")
cols_socialcontexts <- c("M.H21_1","M.H25_1","M.H26_1","M.H28_1")
cols_musicmaking <- c("M.H5_1","M.H6_1","M.H7_1","M.H8_1", "M.H14_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode,  min=1, max=7)
#scoring
scored_data$MH_total <- apply(MH,1, sum) # total BMRQ scores
scored_data$MH_caregiverbeliefs <- apply(MH[cols_caregiverbeliefs], 1,sum)
scored_data$MH_caregiversinging <- apply(MH[cols_caregiversinging],1, sum)
scored_data$MH_childhoodattitude <-apply(MH[cols_childhoodattitude],1, sum)
scored_data$MH_socialcontexts <- apply(MH[cols_socialcontexts],1, sum)
scored_data$MH_musicmaking <- apply(MH[cols_musicmaking],1, sum)
write.csv(scored_data, file='../../data/pleasing-displeasing_followup/scored_data.csv')
first <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
second <- read.csv(file='../../data/SLfollowupscored.csv')
keep <- setdiff(second$ID,first$Q158)
second <- second[second$ID %in% keep, ]
MH <- second %>%
dplyr::select("M.H_child1_1":"M.H_child20_1")
cols_reverse <- c("M.H_child6_1","M.H_child7_1","M.H_child11_1","M.H_child12_1","M.H_child18_1","M.H_child19_1","M.H_child20_1")
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode, min=1, max=7)
first <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
second <- read.csv(file='../../data/SLfollowupscored.csv')
keep <- setdiff(second$ID,first$Q158)
second <- second[second$ID %in% keep, ]
MH <- second %>%
dplyr::select("M.H_child1_1":"M.H_child20_1")
#MH <- MH[complete.cases(MH),]
cols_reverse <- c("M.H_child6_1","M.H_child7_1","M.H_child11_1","M.H_child12_1","M.H_child18_1","M.H_child19_1","M.H_child20_1")
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode, min=1, max=7)
#scoring
cols_caregiverbeliefs <- c("M.H_child1_1","M.H_child2_1","M.H_child3_1","M.H_child4_1")
cols_caregiversinging <- c("M.H_child9_1","M.H_child10_1","M.H_child11_1","M.H_child13_1")
cols_childhoodattitude <- c("M.H_child18_1","M.H_child19_1","M.H_child20_1")
cols_socialcontexts <- c("M.H_child14_1","M.H_child15_1","M.H_child16_1","M.H_child17_1")
cols_musicmaking <- c("M.H_child5_1","M.H_child6_1","M.H_child7_1","M.H_child8_1", "M.H_child12_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode,  min=1, max=7)
first <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
second <- read.csv(file='../../data/SLfollowupscored.csv')
keep <- setdiff(second$ID,first$Q158)
second <- second[second$ID %in% keep, ]
MH <- second %>%
dplyr::select("M.H_child1_1":"M.H_child20_1")
#MH <- MH[complete.cases(MH),]
cols_reverse <- c("M.H_child6_1","M.H_child7_1","M.H_child11_1","M.H_child12_1","M.H_child18_1","M.H_child19_1","M.H_child20_1")
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode, min=1, max=7)
#scoring
cols_caregiverbeliefs <- c("M.H_child1_1","M.H_child2_1","M.H_child3_1","M.H_child4_1")
cols_caregiversinging <- c("M.H_child9_1","M.H_child10_1","M.H_child11_1","M.H_child13_1")
cols_childhoodattitude <- c("M.H_child18_1","M.H_child19_1","M.H_child20_1")
cols_socialcontexts <- c("M.H_child14_1","M.H_child15_1","M.H_child16_1","M.H_child17_1")
cols_musicmaking <- c("M.H_child5_1","M.H_child6_1","M.H_child7_1","M.H_child8_1", "M.H_child12_1")
#scoring
second$MH_total <- apply(MH,1, sum) # total BMRQ scores
second$MH_caregiverbeliefs <- apply(MH[cols_caregiverbeliefs], 1,sum)
second$MH_caregiversinging <- apply(MH[cols_caregiversinging],1, sum)
second$MH_childhoodattitude <-apply(MH[cols_childhoodattitude],1, sum)
second$MH_socialcontexts <- apply(MH[cols_socialcontexts],1, sum)
second$MH_musicmaking <- apply(MH[cols_musicmaking],1, sum)
retest <- merge(second, first)
names(first)[20]<-"ID"
retest <- merge(second, first)
retest <- merge(second, firstby="ID")
View(first)
View(second)
first <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
retest <- merge(second, first,by="ID")
cor.test(retest$MH_childhoodattitude, retest$HomeAttitudes)
cor.test(retest$MH_caregiverbeliefs.x, retest$MH_caregiverbeliefs.y)
library(tidyverse)
library(psych)
library(corrplot)
library(moments)
source("../reverseCode.R")
library(psych)
library(EFAtools)
library(EFA.dimensions)
library(corrplot)
data<-read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
data <- data[complete.cases(data[199:229]),]
MH <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv') %>%
dplyr::select("M.H1_1":"M.H35_1")
#removing check questions
MH <- MH[-c(32:34)]
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H17_1","M.H18_1","M.H20_1","M.H23_1","M.H29_1","M.H30_1",
"M.H32_1")
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode, min=1, max=7)
updateMH <- MH[complete.cases(MH),]
data<-read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
data <- data[complete.cases(data[199:229]),]
MH <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv') %>%
#dplyr::select("M.H1_1":"M.H35_1")
#removing check questions
MH <- MH[-c(32:34)]
data<-read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
data <- data[complete.cases(data[199:229]),]
MH <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv') %>%
#dplyr::select("M.H1_1":"M.H35_1")
#removing check questions
MH <- MH[-c(32:34)]
data<-read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
data <- data[complete.cases(data[199:229]),]
MH <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv') %>%
dplyr::select("M.H1_1":"M.H35_1")
#removing check questions
MH <- MH[-c(32:34)]
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H17_1","M.H18_1","M.H20_1","M.H23_1","M.H29_1","M.H30_1",
"M.H32_1")
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode, min=1, max=7)
updateMH <- MH[complete.cases(MH),]
data<-read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
data <- data[complete.cases(data[199:229]),]
MH <- read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv') %>%
dplyr::select("M.H1_1":"M.H35_1")
#removing check questions
MH <- MH[-c(32:34)]
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H17_1","M.H18_1","M.H20_1","M.H23_1","M.H29_1","M.H30_1",
"M.H32_1")
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode, min=1, max=7)
updateMH <- MH[complete.cases(MH),]
View(data)
scored_data<-read.csv(file='../../data/pleasing-displeasing_followup/scored_data.csv')
master <- read.csv(file="../../data/pleasing-displeasing_followup/pleasing_displeasing_scored.csv")
#names(scored_data)[20] <- "ID"
master <- master[-1]
names(master)[1] <- "ID"
#scoring
MH <- scored_data %>%
dplyr::select("M.H1_1":"M.H35_1")
MH <- MH[-c(32:34)] %>%
dplyr::select(-c("M.H17_1", "M.H20_1", "M.H18_1","M.H19_1","M.H13_1","M.H27_1","M.H23_1")) %>%
dplyr::select( -c("M.H15_1", "M.H24_1")) %>%
dplyr::select( -c("M.H22_1", "M.H31_1"))
#scoring
cols_reverse <- c("M.H6_1","M.H7_1","M.H12_1","M.H14_1","M.H29_1","M.H30_1",
"M.H32_1")
cols_caregiverbeliefs <- c("M.H1_1","M.H2_1","M.H3_1","M.H4_1")
cols_caregiversinging <- c("M.H9_1","M.H10_1","M.H12_1","M.H16_1")
cols_childhoodattitude <- c("M.H29_1","M.H30_1","M.H32_1")
cols_socialcontexts <- c("M.H21_1","M.H25_1","M.H26_1","M.H28_1")
cols_musicmaking <- c("M.H5_1","M.H6_1","M.H7_1","M.H8_1", "M.H14_1")
# Reverse code
MH[cols_reverse] <- lapply(MH[cols_reverse], reverseCode,  min=1, max=7)
#scoring
scored_data$MH_total <- apply(MH,1, sum) # total BMRQ scores
scored_data$MH_caregiverbeliefs <- apply(MH[cols_caregiverbeliefs], 1,sum)
scored_data$MH_caregiversinging <- apply(MH[cols_caregiversinging],1, sum)
scored_data$MH_childhoodattitude <-apply(MH[cols_childhoodattitude],1, sum)
scored_data$MH_socialcontexts <- apply(MH[cols_socialcontexts],1, sum)
scored_data$MH_musicmaking <- apply(MH[cols_musicmaking],1, sum)
write.csv(scored_data, file='../../data/pleasing-displeasing_followup/scored_data.csv')
