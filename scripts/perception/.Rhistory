library(tidyverse)
library(lmerTest)
library(MuMIn)
library(AICcmodavg)
library(sjPlot)
library(corrplot)
library(psych)
library(stats)
all_scored <- read.csv("../../data/pleasing-displeasing_followup/perception/all_scored.csv")
digital_pleasing <- read.csv("../../data/pleasing-displeasing_followup/perception/digital_pleasing.csv")
digital_displeasing <-read.csv("../../data/pleasing-displeasing_followup/perception/digital_displeasing.csv")
IADS_pleasing <- read.csv("../../data/pleasing-displeasing_followup/perception/IADS_pleasing.csv")
IADS_displeasing <- read.csv("../../data/pleasing-displeasing_followup/perception/IADS_displeasing.csv")
names(IADS_displeasing)[3] <- "PASS_total"
#CHAOS childhood negative correlation (MBEA childhood dimensions)
m1 <- lm(scale(MBEA_total) ~ scale(CHAOS_child_total) + scale(threat_childhood_total) + scale(deprivation_child_total) + scale(QUIC_child_total) + scale(PASS_total) + scale(STAI_total) + scale(Gold_musicaltraining), data=all_scored)
summary <- summary(m1)
#CHAOS childhood negative correlation (MBEA childhood dimensions)
range(all_scored$CHAOS_child_total)
newdata <- expand.grid(
CHAOS_child_total=seq(6,29,1)
)
predictions<- predictSE(quadmodel, newdata, se.fit = TRUE, print.matrix =
TRUE, level = 0)
predictions<- predictSE(m1, newdata, se.fit = TRUE, print.matrix =
TRUE, level = 0)
View(newdata)
predictions<- predictSE(m1, newdata, se.fit = TRUE, print.matrix =
TRUE)
all_scored$prediction <- predictSE(m1, all_scored, se.fit = TRUE, print.matrix =
TRUE, level = 0)
library(tidyverse)
library(lme4)
library(sjPlot)
library(effects)
library(lmerTest)
library(emmeans)
library(ggrepel)
library(sjlabelled)
library(sjmisc)
library(nloptr)
library(MuMIn)
library(AICcmodavg)
all_scored$prediction <- predictSE(m1, all_scored, se.fit = TRUE, print.matrix =
TRUE, level = 0)
all_scored$prediction <- predictSE(m1, all_scored, se.fit = TRUE, print.matrix =
TRUE, level = 0)
library(tidyverse)
library(MuMIn)
library(MuMIn)
library(AICcmodavg)
library(sjPlot)
library(AICcmodavg)
library(sjPlot)
library(corrplot)
library(psych)
library(psych)
library(stats)
all_scored <- read.csv("../../data/pleasing-displeasing_followup/perception/all_scored.csv")
digital_pleasing <- read.csv("../../data/pleasing-displeasing_followup/perception/digital_pleasing.csv")
digital_displeasing <-read.csv("../../data/pleasing-displeasing_followup/perception/digital_displeasing.csv")
IADS_pleasing <- read.csv("../../data/pleasing-displeasing_followup/perception/IADS_pleasing.csv")
IADS_displeasing <- read.csv("../../data/pleasing-displeasing_followup/perception/IADS_displeasing.csv")
names(IADS_displeasing)[3] <- "PASS_total"
#CHAOS childhood negative correlation (MBEA childhood dimensions)
m1 <- lm(scale(MBEA_total) ~ scale(CHAOS_child_total) + scale(threat_childhood_total) + scale(deprivation_child_total) + scale(QUIC_child_total) + scale(PASS_total) + scale(STAI_total) + scale(Gold_musicaltraining), data=all_scored)
all_scored$prediction <- predictSE(m1, all_scored, se.fit = TRUE, print.matrix =
TRUE, level = 0)
all_scored$prediction <- predict(m1, all_scored, se.fit = TRUE, print.matrix =
TRUE, level = 0)
View(all_scored)
newdata <- expand.grid(
CHAOS_child_total=seq(6,29,1)
)
newdata$prediction <- predict(m1, newdata, se.fit = TRUE, print.matrix =
TRUE, level = 0)
range(all_scored$threat_childhood_total)
range(all_scored$deprivation_child_total)
range(all_scored$QUIC_child_total)
newdata <- expand.grid(
CHAOS_child_total=seq(6,29,1),
threat_childhood_total=0,
deprivcation_child_total=0,
QUIC_child_total=0,
PASS_total=0,
STAI_total=0,
Gold_musicaltraining=0
)
newdata$prediction <- predict(m1, newdata, se.fit = TRUE, print.matrix =
TRUE, level = 0)
newdata <- expand.grid(
CHAOS_child_total=seq(6,29,1),
threat_childhood_total=0,
deprivation_child_total=0,
QUIC_child_total=0,
PASS_total=0,
STAI_total=0,
Gold_musicaltraining=0
)
newdata$prediction <- predict(m1, newdata, se.fit = TRUE, print.matrix =
TRUE, level = 0)
#CHAOS childhood negative correlation (MBEA childhood dimensions)
m1 <- lm((MBEA_total) ~ (CHAOS_child_total) + (threat_childhood_total) + (deprivation_child_total) + (QUIC_child_total) + (PASS_total) + (STAI_total) + (Gold_musicaltraining), data=all_scored)
newdata <- expand.grid(
CHAOS_child_total=seq(6,29,1),
threat_childhood_total=0,
deprivation_child_total=0,
QUIC_child_total=0,
PASS_total=0,
STAI_total=0,
Gold_musicaltraining=0
)
newdata$prediction <- predict(m1, newdata, se.fit = TRUE, print.matrix =
TRUE, level = 0)
newdata$prediction <- predict(m1, newdata, se.fit = TRUE,se.fit = TRUE, print.matrix =
TRUE, level = 0)
newdata$prediction <- predict(m1, newdata,se.fit = TRUE, print.matrix =
TRUE, level = 0)
predictions <- predict(m1, newdata,se.fit = TRUE, print.matrix =
TRUE, level = 0)
View(predictions)
pred <- cbind(newdata, predictions[["fit"]],predictions[["se.fit"]] )
names(pred)[5:6] <- c("fit", "se.fit")
pred$upper <- (pred$fit + pred$se.fit)
pred$lower <- (pred$fit - pred$se.fit)
View(pred)
newdata <- expand.grid(
CHAOS_child_total=seq(6,29,1),
threat_childhood_total=0,
deprivation_child_total=0,
QUIC_child_total=0,
PASS_total=0,
STAI_total=0,
Gold_musicaltraining=0
)
predictions <- predict(m1, newdata,se.fit = TRUE, print.matrix =
TRUE, level = 0)
pred <- cbind(newdata, predictions[["fit"]],predictions[["se.fit"]] )
names(pred)[5:6] <- c("fit", "se.fit")
pred$upper <- (pred$fit + pred$se.fit)
pred$lower <- (pred$fit - pred$se.fit)
View(pred)
View(pred)
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point()+
geom_abline(method="lm")
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point()+
geom_smooth(method="lm")
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))+
geom_smooth(method="lm")
pred$upper <- (pred$fit + pred$predictions[["fit"]]`)
pred$lower <- (pred$fit - pred$predictions[["fit"]]`)
pred$upper <- (pred$fit + `pred$predictions[["fit"]]`)
pred$upper <- (pred$fit + `pred$`predictions[["fit"]]`)
pred$upper <- (pred$fit + pred$`predictions[["fit"]]`)
pred$lower <- (pred$fit - `pred$predictions[["fit"]]`)
pred$lower <- (pred$fit - pred$`predictions[["fit"]]`)
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))+
geom_smooth(method="lm") +
geom_ribbon(aes(ymin=lower, ymax=upper+))
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))+
geom_smooth(method="lm") +
geom_ribbon(aes(ymin=lower, ymax=upper))
pred$upper <- (pred$fit + pred$`predictions[["se.fit"]]`)
pred$lower <- (pred$fit - pred$`predictions[["se.fit"]]`)
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))+
geom_smooth(method="lm") +
geom_ribbon(aes(ymin=lower, ymax=upper))
pred$upper <- (pred$`predictions[["fit"]]` + pred$`predictions[["se.fit"]]`)
pred$lower <- (pred$`predictions[["fit"]]` - pred$`predictions[["se.fit"]]`)
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))+
geom_smooth(method="lm") +
geom_ribbon(aes(ymin=lower, ymax=upper))
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))+
geom_smooth(method="lm") +
geom_ribbon(aes(ymin=lower, ymax=upper), alpha=0.2)
theme_classic() +
xlab("CHAOS Score") +
ylab("MBEA Score")
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))+
geom_smooth(method="lm") +
geom_ribbon(aes(ymin=lower, ymax=upper), alpha=0.2)
#plot predictions
ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))+
geom_smooth(method="lm") +
geom_ribbon(aes(ymin=lower, ymax=upper), alpha=0.2)+
theme_classic() +
xlab("CHAOS Score") +
ylab("MBEA Score")
#plot predictions
CHAOSMBEApred <- ggplot(data=pred, aes(x=CHAOS_child_total, y=`predictions[["fit"]]`))+
geom_point(data=all_scored, aes(x=CHAOS_child_total, y=MBEA_total))+
geom_smooth(method="lm") +
geom_ribbon(aes(ymin=lower, ymax=upper), alpha=0.2)+
theme_classic() +
xlab("CHAOS Score") +
ylab("MBEA Score")
ggsave(plot=CHAOSMBEApred, '../../figures/pleasing:displeasing_followup/full_sample/CHAOSMBEApred.png', width=10)
